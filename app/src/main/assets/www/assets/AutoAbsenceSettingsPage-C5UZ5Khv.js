import{Q as b}from"./QSpinnerGears-DmolwAR1.js";import{_ as P,aP as B,aO as E,B as _,A as x,Y as F,C as L,Q as i,S as s,a6 as e,a5 as a,aE as N,aF as p,a8 as u,ad as g,ab as Q,a3 as h,ah as T,a4 as S,a9 as D,aa as G,av as R,R as V,aV as $,aw as z,a2 as w,ay as k,ax as O,aG as Y,aC as j}from"./index-Bl2lQPd7.js";import{Q as A}from"./QBanner-xBGiroIy.js";import{Q as J,a as C}from"./QItem-De3v03wU.js";import{Q as K}from"./QItemLabel-BkJiB6aE.js";import{Q as M}from"./QTime-DY-qDies.js";import{Q as q}from"./QPopupProxy-CQ30ymZI.js";import{Q as W}from"./QForm-Dk45GsL9.js";import{Q as X}from"./QInnerLoading-WxvcYHvS.js";import{u as Z}from"./composables-CAkrP3jA.js";import"./TouchPan-jBhMORlX.js";import"./touch-BjYP5sR0.js";import"./selection-DaBtDCZ0.js";import"./use-datetime-hbLWgGn4.js";import"./date-C1Mon-Jj.js";import"./format-IcNrutKL.js";import"./QMenu-BNr9Tzvf.js";import"./position-engine-o8Q2RudZ.js";const ee={class:"text-center"},ae={class:"text-subtitle1 text-primary q-mb-sm"},te={key:0,class:"row q-col-gutter-md"},oe={class:"col-12 col-md-6"},le={class:"col-12 col-md-6"},se={__name:"AutoAbsenceSettingsPage",setup(ie){const r=B();E();const{setTitle:H}=Z(),f=_(()=>r.getters["absence/autoSettings/isLoading"]),c=x(!1),m=_(()=>r.getters["absence/autoSettings/allSettings"]),v=_(()=>r.getters["absence/autoSettings/error"]),d=x([]);F(m,n=>{console.log("New settings:",n),d.value=[...n]},{deep:!0,immediate:!0});const y=()=>{r.dispatch("absence/autoSettings/fetchSettingsAndCycles")};L(()=>{H("Paramétrage Absences Automatiques"),y()});const U=async()=>{c.value=!0;const n=d.value.map(l=>({idcycle:l.idcycle,is_active:l.is_active,morning_execution_time:l.morning_execution_time||null,midday_execution_time:l.midday_execution_time||null}));r.state.absence.autoSettings.settings=[...n],await r.dispatch("absence/autoSettings/saveSettings"),c.value=!1};return(n,l)=>(s(),i(j,{padding:"",class:"page-content"},{default:e(()=>[a(N,{flat:""},{default:e(()=>[f.value&&!m.value.length?(s(),i(p,{key:0},{default:e(()=>[u("div",ee,[a(b,{size:"50px",color:"primary"}),l[0]||(l[0]=u("div",{class:"q-mt-md"},"Chargement des paramètres...",-1))])]),_:1})):v.value&&!m.value.length?(s(),i(p,{key:1},{default:e(()=>[a(A,{"inline-actions":"",class:"text-white bg-negative"},{action:e(()=>[a(h,{flat:"",color:"white",label:"Réessayer",onClick:y})]),default:e(()=>[g(Q(v.value)+" ",1)]),_:1})]),_:1})):!m.value.length&&!f.value?(s(),i(p,{key:2},{default:e(()=>[a(A,{class:"bg-info text-white"},{default:e(()=>l[1]||(l[1]=[g(" Aucun cycle actif trouvé ou aucun paramètre à configurer pour le moment. ")])),_:1})]),_:1})):(s(),i(W,{key:3,onSubmit:T(U,["prevent"])},{default:e(()=>[(s(!0),S(D,null,G(d.value,(o,I)=>(s(),i(p,{key:o.idcycle,class:""},{default:e(()=>[u("div",ae," Cycle: "+Q(o.cycle?.cycle||`Cycle ID ${o.idcycle}`),1),R((s(),i(J,{tag:"label",class:"q-mb-md rounded-borders",style:{border:"1px solid #e0e0e0"}},{default:e(()=>[a(C,{avatar:""},{default:e(()=>[a($,{modelValue:o.is_active,"onUpdate:modelValue":t=>o.is_active=t,color:"primary"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),a(C,null,{default:e(()=>[a(K,null,{default:e(()=>l[2]||(l[2]=[g("Activer le marquage automatique pour ce cycle")])),_:1})]),_:1})]),_:2},1024)),[[z]]),o.is_active?(s(),S("div",te,[u("div",oe,[a(w,{filled:"",modelValue:o.morning_execution_time,"onUpdate:modelValue":t=>o.morning_execution_time=t,label:"Heure Exécution Matinée (HH:MM)",mask:"##:##",clearable:"",rules:[t=>t===null||t===""||/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/.test(t)||"Format HH:MM requis"]},{append:e(()=>[a(k,{name:"access_time",class:"cursor-pointer"},{default:e(()=>[a(q,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:e(()=>[a(M,{modelValue:o.morning_execution_time,"onUpdate:modelValue":t=>o.morning_execution_time=t,format24h:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue","rules"])]),u("div",le,[a(w,{filled:"",modelValue:o.midday_execution_time,"onUpdate:modelValue":t=>o.midday_execution_time=t,label:"Heure Exécution Après-Midi (HH:MM)",mask:"##:##",clearable:"",rules:[t=>t===null||t===""||/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/.test(t)||"Format HH:MM requis"]},{append:e(()=>[a(k,{name:"access_time",class:"cursor-pointer"},{default:e(()=>[a(q,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:e(()=>[a(M,{modelValue:o.midday_execution_time,"onUpdate:modelValue":t=>o.midday_execution_time=t,format24h:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue","rules"])])])):V("",!0),I<d.value.length-1?(s(),i(O,{key:1,class:"q-mt-lg"})):V("",!0)]),_:2},1024))),128)),a(Y,{align:"right",class:"q-pa-md"},{default:e(()=>[a(h,{label:"Enregistrer les Paramètres",type:"submit",color:"primary",icon:"save",loading:c.value},null,8,["loading"])]),_:1})]),_:1})),a(X,{showing:c.value},{default:e(()=>[a(b,{size:"50px",color:"primary"})]),_:1},8,["showing"])]),_:1})]),_:1}))}},we=P(se,[["__scopeId","data-v-2256833a"]]);export{we as default};
