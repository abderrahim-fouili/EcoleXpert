import{Q as b,a as p}from"./QItem-De3v03wU.js";import{Q as C}from"./QList-CMzNTEGD.js";import{Q as A}from"./QMenu-BNr9Tzvf.js";import{_ as T,ar as R,aq as H,as as W,at as G,ag as g,a4 as w,S as r,Q as u,R as d,a5 as e,a6 as t,ad as f,ab as m,a3 as c,a9 as _,aa as x,av as D,aw as V,a8 as a,ax as v,a7 as J,ay as k,af as N,az as j,aA as K,aD as q,aJ as X,aB as S}from"./index-Bl2lQPd7.js";import{Q as O}from"./QToolbarTitle-C8APieXG.js";import{Q as M}from"./QBadge-Bjfo5tRO.js";import{Q}from"./QItemLabel-BkJiB6aE.js";import{Q as Y}from"./QExpansionItem-EMhshZ_3.js";import{Q as Z}from"./QScrollArea-DbARZhEV.js";import{_ as $,Q as ee}from"./SchoolSwitcher-D06IRcd0.js";import{Q as te}from"./QToolbar-DR-_wX4W.js";import{Q as oe}from"./QFooter-BqOQs2Wv.js";import{C as le}from"./ClosePopup-BY_YGFBZ.js";import{E as se}from"./Header-iKAj_IF4.js";import{N as ne}from"./Notifications-DUxCRqy9.js";import{C as re,S as ie}from"./Contact-BnHMrRuo.js";import{s as z}from"./notif-Ca_8-ZkB.js";import"./position-engine-o8Q2RudZ.js";import"./selection-DaBtDCZ0.js";import"./QSlideTransition-CrdUnXBf.js";import"./TouchPan-jBhMORlX.js";import"./touch-BjYP5sR0.js";import"./format-IcNrutKL.js";import"./composables-CAkrP3jA.js";import"./QBanner-xBGiroIy.js";import"./QPageSticky-adQ0nSeI.js";import"./QHeader-B4MlZ-LM.js";import"./QSpace-CKKoNTi_.js";import"./groupBy-BgHPVcz-.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./_curry1-CPMemvwC.js";import"./_xfBase-ZXVHuZFu.js";import"./_reduce-BZMr9wpn.js";import"./_isArrayLike-B3kKjEvQ.js";import"./index-Dx01H97j.js";import"./index-CbPSoDvq.js";import"./QImg-BMvxJu3S.js";const ae={name:"MyLayout",data(){return{isFullscreen:!1,settingeDialog:!1,showNotifs:!1,showSortie:!1,showContact:!1,drawerOpen:this.$q.platform.is.desktop}},components:{EpHeader:se,Notifications:ne,Sortie:ie,Contact:re,SchoolSwitcher:$},computed:{...G({user:"user/user",config:"user/config",links:"user/nav",current:"user/current",notificationCounter:"notification/counter",darkMode:"darkMode",title:"title",footer:"footer"}),annees(){return this.config&&this.config.meta.hasOwnProperty("annees")?this.config.meta.annees:[]},annee(){if(this.current&&this.current.hasOwnProperty("annee"))return this.current.annee},dark:{get(){return this.darkMode},set(s){this.toggleDarkMode()}}},methods:{...W({logout:"user/logout",nav:"user/nav",setDefaults:"user/setDefaults",togglAnnee:"user/setAnnee",getEmploi:"emploi/getData",getDevoirs:"devoirs/getDevoirs",setCounter:"notification/setCounter",toggleDarkMode:"toggleDarkMode"}),isDev:H,openURL:R,clearNotifCounter(){this.setCounter(0)},subscribeAll(s){if(this.$q.platform.is.cordova){let o="ecoleplus_"+s;z(o+"_admin"),z(o+"_"+this.user.idpers)}},setAnnee(s){this.togglAnnee(s),this.go("/transport")},avatar(){return S(this.user)},personAvatar(s){return S(s)},deconnexion(){this.logout(),this.$router.push("/login")},minimize(){},maximize(){},fullscreen(){this.$q.electron.remote.BrowserWindow.getFocusedWindow().setFullScreen(this.isFullscreen=!this.isFullscreen)},close(){}},watch:{annee(){}},created(){X("transport")},mounted(){this.canAccess(this.config),this.nav(),this.setDefaults(this.config)}},ue={class:"col-xs-10",style:{position:"relative"}},de={class:"absolute-top text-white bg1",style:{height:"150px",overflow:"hidden"}},fe={class:"absolute-bottom text-center"},me=["src"],ce={class:"text-weight-bold text-white text-shadow q-mb-xl"},pe={class:"col-xs-2 bg-white text-dark q-pt-lg q-pb-lg q-pr-xs",style:{position:"relative"}},he={class:"flex flex-center full-width"},ge={class:"flex flex-center full-width"},we={class:"absolute-bottom"},_e={class:"flex flex-center full-width"};function be(s,o,ve,ke,n,i){const F=g("ep-header"),B=g("school-switcher"),P=g("router-view"),L=g("notifications"),U=g("sortie"),E=g("contact");return r(),w(_,null,[s.user?(r(),u(K,{key:0,view:"hhr lpR fFr",class:N({page:!0})},{default:t(()=>[e(F,null,{toolbar:t(()=>[i.annees.length&&i.annee?(r(),u(c,{key:0,flat:"",icon:"pending_actions",dark:""},{default:t(()=>[f(m(i.annee.description)+" ",1),e(A,null,{default:t(()=>[e(C,{link:""},{default:t(()=>[(r(!0),w(_,null,x(i.annees,(l,y)=>D((r(),u(b,{clickable:"",key:y,onClick:h=>i.setAnnee(l),active:i.annee.idannee===l.idannee},{default:t(()=>[e(p,null,{default:t(()=>[f(m(l.description),1)]),_:2},1024)]),_:2},1032,["onClick","active"])),[[le],[V]])),128))]),_:1})]),_:1})]),_:1})):d("",!0),e(O),e(c,{onClick:o[0]||(o[0]=l=>s.go("/")),flat:"",round:"",dense:"",icon:"icon_home",class:"q-mr-xs"}),e(c,{flat:"",round:"",dense:"",icon:"icon_menu_burger",onClick:o[1]||(o[1]=l=>n.drawerOpen=!n.drawerOpen),"aria-label":"Menu"},{default:t(()=>[s.notificationCounter>0?(r(),u(M,{key:0,color:"warning",floating:""},{default:t(()=>[f(m(s.notificationCounter),1)]),_:1})):d("",!0)]),_:1})]),title:t(()=>[f(m(s.title),1)]),_:1}),e(ee,{modelValue:n.drawerOpen,"onUpdate:modelValue":o[5]||(o[5]=l=>n.drawerOpen=l),side:"right",dark:"",elevated:"",class:"bg-secondary row"},{default:t(()=>[a("div",ue,[e(Z,{style:{height:"calc(100% - 150px)","margin-top":"150px"}},{default:t(()=>[e(C,{bordered:""},{default:t(()=>[(r(!0),w(_,null,x(s.links,(l,y)=>(r(),w(_,null,[l.haschildren&&l.items.length?(r(),u(Y,{key:0,label:l.label},{default:t(()=>[e(C,null,{default:t(()=>[(r(!0),w(_,null,x(l.items,(h,I)=>(r(),w(_,null,[i.isDev()||!h.disable?D((r(),u(b,{clickable:"",to:h.to,key:I,disable:i.isDev()?!1:h.disable,exact:!h.hasOwnProperty("haschildren")},{default:t(()=>[e(p,null,{default:t(()=>[e(Q,null,{default:t(()=>[f(m(h.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to","disable","exact"])),[[V]]):d("",!0)],64))),256))]),_:2},1024)]),_:2},1032,["label"])):i.isDev()||!l.disable?D((r(),u(b,{clickable:"",to:l.to,key:y,disable:i.isDev()?!1:l.disable,exact:!l.hasOwnProperty("haschildren")},{default:t(()=>[e(p,null,{default:t(()=>[e(Q,null,{default:t(()=>[f(m(l.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to","disable","exact"])),[[V]]):d("",!0),l.disable?d("",!0):(r(),u(v,{key:2}))],64))),256))]),_:1})]),_:1}),a("div",de,[a("div",fe,[e(J,{size:"56px",class:"q-mb-sm"},{default:t(()=>[a("img",{src:i.avatar(s.user)},null,8,me),e(A,null,{default:t(()=>[e(C,{link:""},{default:t(()=>[e(b,{to:"/personnel",clickable:""},{default:t(()=>[e(p,{side:""},{default:t(()=>[e(k,{name:"account_circle"})]),_:1}),e(p,null,{default:t(()=>[e(Q,null,{default:t(()=>o[11]||(o[11]=[f(" Profil ")])),_:1})]),_:1})]),_:1}),e(v),e(b,{onClick:i.deconnexion,clickable:""},{default:t(()=>[e(p,{side:""},{default:t(()=>[e(k,{name:"power_settings_new"})]),_:1}),e(p,null,{default:t(()=>[e(Q,null,{default:t(()=>o[12]||(o[12]=[f(" DÃ©connexion ")])),_:1})]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),a("div",ce,m(s.user.nom)+" "+m(s.user.prenom),1)])])]),a("div",pe,[e(c,{class:"full-width q-mb-sm",flat:"",onClick:o[2]||(o[2]=l=>n.drawerOpen=!n.drawerOpen),"aria-label":"Menu"},{default:t(()=>[e(k,{name:"icon_menu_burger"})]),_:1}),a("div",he,[e(v,{style:{width:"50%"}})]),e(c,{class:N({"full-width":!0,"q-mt-sm":!0,greyscale:s.notificationCounter==0}),size:"lg",flat:"",dense:"",onClick:o[3]||(o[3]=l=>n.showNotifs=!n.showNotifs),"aria-label":"Menu"},{default:t(()=>[s.notificationCounter>0?(r(),u(M,{key:0,color:"warning",floating:""},{default:t(()=>[f(m(s.notificationCounter),1)]),_:1})):d("",!0),o[13]||(o[13]=a("img",{src:"leaf.svg",class:"full-width"},null,-1))]),_:1},8,["class"]),a("div",ge,[e(v,{style:{width:"50%"}})]),e(c,{flat:"",class:N({"full-width":!0,"q-mt-sm":!0}),onClick:o[4]||(o[4]=l=>n.showContact=!n.showContact)},{default:t(()=>[e(k,{name:"icon_uniF2C3"})]),_:1}),e(B),a("div",we,[a("div",_e,[e(v,{style:{width:"50%"}})]),e(c,{onClick:i.deconnexion,color:"red",flat:"",size:"lg",class:"full-width"},{default:t(()=>[e(k,{name:"power_settings_new"})]),_:1},8,["onClick"])])])]),_:1},8,["modelValue"]),e(j,null,{default:t(()=>[i.annee?(r(),u(P,{key:0})):d("",!0)]),_:1}),s.footer?(r(),u(oe,{key:0,class:"bg-secondary"},{default:t(()=>[e(te,null,{default:t(()=>[e(O,null,{default:t(()=>[e(c,{icon:"icon_retour_mobile",flat:"",onClick:o[6]||(o[6]=l=>s.$router.go(-1))})]),_:1}),o[14]||(o[14]=a("div",{id:"footer-portal"},null,-1))]),_:1})]),_:1})):d("",!0)]),_:1})):d("",!0),e(q,{modelValue:n.showNotifs,"onUpdate:modelValue":o[8]||(o[8]=l=>n.showNotifs=l),position:"right",maximized:"",onHide:i.clearNotifCounter},{default:t(()=>[e(L,{"onNotif:close":o[7]||(o[7]=l=>{n.showNotifs=!1,n.drawerOpen=!1})})]),_:1},8,["modelValue","onHide"]),e(q,{modelValue:n.showSortie,"onUpdate:modelValue":o[9]||(o[9]=l=>n.showSortie=l),position:"right",maximized:""},{default:t(()=>[e(U)]),_:1},8,["modelValue"]),e(q,{modelValue:n.showContact,"onUpdate:modelValue":o[10]||(o[10]=l=>n.showContact=l),position:"right",maximized:""},{default:t(()=>[e(E)]),_:1},8,["modelValue"])],64)}const nt=T(ae,[["render",be]]);export{nt as default};
