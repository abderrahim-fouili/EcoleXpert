import{Q as C}from"./QBadge-Bjfo5tRO.js";import{_ as E,ar as Z,b4 as ee,as as N,at as Y,aB as B,aY as K,b5 as te,aW as se,J as le,Q as h,S as u,a6 as l,a5 as s,af as P,av as V,a3 as p,ad as d,ab as f,b6 as de,aF as L,R as c,a8 as g,a2 as q,ay as b,b7 as ue,aG as O,aE as Q,aK as $,b8 as fe,b9 as me,b2 as pe,ba as he,ag as z,a4 as v,ax as H,a9 as D,aa as U,ac as W,ah as ce,aD as R,aC as ge,a as j,ds as I}from"./index-Bl2lQPd7.js";import{Q as m}from"./QItemLabel-BkJiB6aE.js";import{Q as k,a as y}from"./QItem-De3v03wU.js";import{Q as X}from"./QList-CMzNTEGD.js";import{Q as x}from"./QToolbarTitle-C8APieXG.js";import{Q as A}from"./QToolbar-DR-_wX4W.js";import{Q as J}from"./QForm-Dk45GsL9.js";import{C as F}from"./ClosePopup-BY_YGFBZ.js";import{q as ve}from"./format-IcNrutKL.js";import{Q as M}from"./QSelect-DchnWyXK.js";import{Q as ie}from"./QDate-C_jC-zMt.js";import{Q as re}from"./QPopupProxy-CQ30ymZI.js";import{Q as S}from"./QTooltip-r7WoEuzy.js";import{Q as ye}from"./QUploaderAddTrigger-OZIUWg9a.js";import{Q as be}from"./QUploader-Dwk8_y__.js";import{f as T}from"./index-C9ZTL5MN.js";import"./QChip-C9OfA2gn.js";import"./QMenu-BNr9Tzvf.js";import"./position-engine-o8Q2RudZ.js";import"./selection-DaBtDCZ0.js";import"./rtl-DFPa-2ov.js";import"./use-render-cache-DLxPkVnQ.js";import"./use-datetime-hbLWgGn4.js";import"./date-C1Mon-Jj.js";import"./QCircularProgress-C_b7NmsY.js";import"./index-BXMW6yyY.js";import"./index-CbPSoDvq.js";const we={data(){return{cfiles:0}},props:{title:{default:()=>"Nouveau devoir"}},computed:{...Y({user:"user/user",config:"user/config",current:"user/current",form:"ds/form",emploi:"profEmploi/data",settings:"ds/settings"}),disciplines(){if(this.emploi&&this.emploi.length){let e=null;return this.emploi.reduce((t,i)=>(i.classes&&i.classes.idclasse===this.classe.idclasse&&i.matiere.discipline.length&&i.matiere.discipline[0].iddiscipline!=e&&(t.push(i.matiere.discipline[0]),e=i.matiere.discipline[0].iddiscipline),t),[])}return[]},uploadFields(){return[{name:"notReponse",value:!0}]},classe(){if(this.current&&this.current.hasOwnProperty("classe"))return this.current.classe},options(){return this.classes},classes(){return this.current&&this.current.hasOwnProperty("classes")?this.current.classes:[]},annee(){if(this.current&&this.current.hasOwnProperty("annee"))return this.current.annee},headers(){return[{name:"Authorization",value:le.defaults.headers.common.Authorization}]},url(){return se("api")+"/ds/pj"}},methods:{...N({create:"ds/create",update:"ds/update"}),isDate:ee,openURL:Z,minDate(e){return e>=T(new Date,"yyyy/MM/dd")},isImage(e){return te(this.fileUrl(e))},fileUrl(e){return K(e)},personAvatar(e){return B(e)},added(e){this.cfiles=e.length},removed(e){this.cfiles-=e.length},attach(){this.$nextTick(()=>{this.$refs.uploader.pickFiles()})},send(){this.$refs.form.validate().then(e=>{if(!e)return this.$q.notify({color:"negative",message:this.$t("stats.fields"),position:"bottom",icon:"error_outline",actions:[{label:this.$q.lang.label.close,color:"yellow"}]}),!1;this.cfiles>0?this.$refs.uploader.upload():this.sendMessage()})},sendMessage(e){let t=[],i=Object.assign({},this.form);i.fichiers=[],e&&(t=JSON.parse(e.xhr.response).result),i.idannee=this.annee.idannee;let w={files:t,...i};this.form.id?this.update(w).then(a=>{this.$emit("devoir:sent",{d:a,isNew:!1})}).catch(a=>{this.$q.notify({color:"negative",message:this.$t("stats.fields"),position:"bottom",icon:"error_outline",actions:[{label:this.$q.lang.label.close,color:"yellow"}]}),this.$emit("devoir:error",a)}):this.create(w).then(a=>{this.$emit("devoir:sent",{d:a,isNew:!0})}).catch(a=>{this.$q.notify({color:"negative",message:this.$t("stats.fields"),position:"bottom",icon:"error_outline",actions:[{label:this.$q.lang.label.close,color:"yellow"}]}),this.$emit("devoir:error",a)})},choice(e){this.step=e.value.step,this.$nextTick(()=>{if(this.form.destinataire=this.destinataire.map(i=>i.value.idpers?{type:"personne",id:i.value.idpers,value:"personne_"+i.value.idpers,label:i.label}:i),this.step!=="personnes"&&e.value.value)this.destinataire=null,this.setOptions(),this.$refs.dest.refresh(),this.steps.push(e.value);else if(e.value.value===0)for(var t=0;t<this.steps.length;t++)this.steps[t].step===e.value.step&&delete this.steps[t]})},clear(){this.destinataire=null,this.step=null,this.steps=[],this.setOptions()},hasDiscs(e){return e.value.disciplines&&e.value.disciplines.length},discs(e){return e.value.disciplines[0].description}},activated(){this.cfiles=this.form.fichiers.length}},_e={class:"row items-center justify-end"},ke={class:"row"},Ce={class:"col-xs-12"},Ve={class:"row no-wrap items-center q-pa-sm q-gutter-xs",style:{}},De={class:"col"},qe={class:"q-uploader__subtitle"};function Fe(e,t,i,w,a,o){return u(),h(Q,null,{default:l(()=>[s(A,{class:P({"bg-secondary":!e.form.status,"bg-positive":e.form.status,"text-white":!0,"shadow-2":!0})},{default:l(()=>[V(s(p,{flat:"",dense:"",icon:"arrow_back"},null,512),[[F]]),s(x,null,{default:l(()=>[d(f(i.title),1)]),_:1}),s(p,{flat:"",dense:"",icon:"attach_file",onClick:o.attach,disable:!!e.form.status},{default:l(()=>[V(s(C,{floating:"",color:"yellow-9"},{default:l(()=>[d(f(a.cfiles),1)]),_:1},512),[[de,a.cfiles>0]])]),_:1},8,["onClick","disable"]),s(p,{class:"q-ml-lg",flat:"",icon:"send",onClick:o.send,disable:!!e.form.status},null,8,["onClick","disable"])]),_:1},8,["class"]),s(L,{style:{"overflow-y":"scroll"}},{default:l(()=>[s(J,{class:"q-gutter-sm",ref:"form"},{default:l(()=>[s(M,{filled:"",modelValue:e.form.classes,"onUpdate:modelValue":t[0]||(t[0]=r=>e.form.classes=r),multiple:"",options:o.options,rules:[r=>r.length>0||"Champ requis"],label:"Classes","emit-value":"","option-value":"idclasse","option-label":"classe_fr","map-options":""},null,8,["modelValue","options","rules"]),e.settings?(u(),h(M,{key:0,filled:"",modelValue:e.form.type,"onUpdate:modelValue":t[1]||(t[1]=r=>e.form.type=r),options:e.settings.types,rules:[r=>r!==null||"Champ requis"],label:"Type","emit-value":"","map-options":""},null,8,["modelValue","options","rules"])):c("",!0),s(M,{filled:"",modelValue:e.form.discipline,"onUpdate:modelValue":t[2]||(t[2]=r=>e.form.discipline=r),options:o.disciplines,rules:[r=>r||"Champ requis"],label:"Matière","emit-value":"","option-value":"iddiscipline","option-label":"description","map-options":""},null,8,["modelValue","options","rules"]),s(q,{onClick:t[5]||(t[5]=r=>e.$refs.date_ds.show()),label:"Date",filled:"",modelValue:e.form.date_ds,"onUpdate:modelValue":t[6]||(t[6]=r=>e.form.date_ds=r),mask:"####-##-##",rules:[o.isDate]},{append:l(()=>[s(b,{name:"event",class:"cursor-pointer"},{default:l(()=>[s(re,{ref:"date_ds",cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[s(ie,{options:o.minDate,minimal:"",modelValue:e.form.date_ds,"onUpdate:modelValue":[t[3]||(t[3]=r=>e.form.date_ds=r),t[4]||(t[4]=r=>e.$refs.date_ds.hide())],mask:"YYYY-MM-DD"},{default:l(()=>[g("div",_e,[V(s(p,{label:"Fermer",color:"primary",flat:""},null,512),[[F]])])]),_:1},8,["options","modelValue"])]),_:1},512)]),_:1})]),_:1},8,["modelValue","rules"]),s(q,{filled:"",modelValue:e.form.titre,"onUpdate:modelValue":t[7]||(t[7]=r=>e.form.titre=r),label:"Titre",rules:[r=>!!r||"Champ requis"],"lazy-rules":""},null,8,["modelValue","rules"]),s(q,{filled:"",modelValue:e.form.description,"onUpdate:modelValue":t[8]||(t[8]=r=>e.form.description=r),autogrow:"",type:"textarea",label:"Descrption","lazy-rules":"","input-style":"min-height:150px"},null,8,["modelValue"]),g("div",ke,[g("div",Ce,[s(be,{"field-name":r=>"pieces_jointe[]",style:{width:"100%"},url:o.url,flat:"",multiple:"",headers:o.headers,"form-fields":o.uploadFields,ref:"uploader",batch:"",onAdded:o.added,onRemoved:o.removed,onUploaded:o.sendMessage},{header:l(r=>[g("div",Ve,[r.queuedFiles.length>0?(u(),h(p,{key:0,icon:"clear_all",onClick:r.removeQueuedFiles,round:"",dense:"",flat:""},{default:l(()=>[s(S,null,{default:l(()=>t[9]||(t[9]=[d("Supprimer tous")])),_:1})]),_:2},1032,["onClick"])):c("",!0),r.uploadedFiles.length>0?(u(),h(p,{key:1,icon:"done_all",onClick:r.removeUploadedFiles,round:"",dense:"",flat:""},{default:l(()=>[s(S,null,{default:l(()=>t[10]||(t[10]=[d("Supprimer")])),_:1})]),_:2},1032,["onClick"])):c("",!0),r.isUploading?(u(),h(ue,{key:2,class:"q-uploader__spinner"})):c("",!0),g("div",De,[t[11]||(t[11]=g("div",{class:"q-uploader__title"},"Pieces Jointe",-1)),g("div",qe,f(r.uploadSizeLabel)+" / "+f(r.uploadProgressLabel),1)]),r.canAddFiles?(u(),h(p,{key:3,type:"a",icon:"add_box",round:"",dense:"",flat:""},{default:l(()=>[s(ye),s(S,null,{default:l(()=>t[12]||(t[12]=[d("Ajouter des fichiers")])),_:1})]),_:1})):c("",!0),r.isUploading?(u(),h(p,{key:4,icon:"clear",onClick:r.abort,round:"",dense:"",flat:""},{default:l(()=>[s(S,null,{default:l(()=>t[13]||(t[13]=[d("Annuler")])),_:1})]),_:2},1032,["onClick"])):c("",!0)])]),_:1},8,["url","headers","form-fields","onAdded","onRemoved","onUploaded"])])])]),_:1},512)]),_:1}),s(O,{align:"right",class:""},{default:l(()=>[s(p,{label:"Envoyer",icon:"send",onClick:o.send,disable:!!e.form.status},null,8,["onClick","disable"])]),_:1})]),_:1})}const Qe=E(we,[["render",Fe]]),Ue={data(){return{filteredClasses:[]}},props:{title:{default:()=>"Filtre"},form:{default:()=>({date_ds:null,titre:null,obligatoire:null})},globalSettings:{default:()=>null}},computed:{...Y({user:"user/user",config:"user/config",current:"user/current"}),uploadFields(){return[{name:"notReponse",value:!0}]},classe(){if(this.current&&this.current.hasOwnProperty("classe"))return this.current.classe},options(){return this.classes},classes(){return this.globalSettings&&this.globalSettings.hasOwnProperty("classes")?this.globalSettings.classes:[]},annee(){if(this.current&&this.current.hasOwnProperty("annee"))return this.current.annee},headers(){return[{name:"Authorization",value:le.defaults.headers.common.Authorization}]},url(){return se("api")+"/devoirs/pj"}},methods:{...N({create:"devoirs/create",update:"devoirs/update"}),isDate:ee,openURL:Z,filterClasses(e,t){if(e===""){t(()=>{this.filteredClasses=this.classes});return}t(()=>{const i=e.toLowerCase();this.filteredClasses=this.classes.filter(w=>w.classe_fr.toLowerCase().indexOf(i)>-1)})},minDate(e){return e>=T(new Date,"yyyy/MM/dd")},isImage(e){return te(this.fileUrl(e))},fileUrl(e){return K(e)},personAvatar(e){return B(e)},send(){this.$refs.form.validate().then(e=>{if(!e)return this.$q.notify({color:"negative",message:this.$t("stats.fields"),position:"bottom",icon:"error_outline",actions:[{label:this.$q.lang.label.close,color:"yellow"}]}),!1;this.sendMessage()})},sendMessage(){this.$emit("devoir:filter",{filter:this.form})},choice(e){this.step=e.value.step,this.$nextTick(()=>{if(this.form.destinataire=this.destinataire.map(i=>i.value.idpers?{type:"personne",id:i.value.idpers,value:"personne_"+i.value.idpers,label:i.label}:i),this.step!=="personnes"&&e.value.value)this.destinataire=null,this.setOptions(),this.$refs.dest.refresh(),this.steps.push(e.value);else if(e.value.value===0)for(var t=0;t<this.steps.length;t++)this.steps[t].step===e.value.step&&delete this.steps[t]})},clear(){this.destinataire=null,this.step=null,this.steps=[],this.setOptions()},hasDiscs(e){return e.value.disciplines&&e.value.disciplines.length},discs(e){return e.value.disciplines[0].description}},mounted(){this.filteredClasses=this.classes}},Se={class:"row items-center justify-end"};function Me(e,t,i,w,a,o){return u(),h(Q,null,{default:l(()=>[s(A,{class:P({"bg-secondary":!i.form.status,"bg-positive":i.form.status,"text-white":!0,"shadow-2":!0})},{default:l(()=>[V(s(p,{flat:"",dense:"",icon:"arrow_back"},null,512),[[F]]),s(x,null,{default:l(()=>t[6]||(t[6]=[d(" Filtre ")])),_:1}),s(p,{class:"q-ml-lg",flat:"",icon:"filter_list",onClick:o.send},null,8,["onClick"])]),_:1},8,["class"]),s(L,{style:{"overflow-y":"scroll"}},{default:l(()=>[s(J,{class:"q-gutter-lg",ref:"form"},{default:l(()=>[s(M,{filled:"",modelValue:i.form.classes,"onUpdate:modelValue":t[0]||(t[0]=r=>i.form.classes=r),multiple:"",options:a.filteredClasses,label:"Classes","emit-value":"","option-value":"idclasse","option-label":"classe_fr","map-options":"",clearable:""},null,8,["modelValue","options"]),s(q,{onKeydown:$(o.send,["enter"]),clearable:"",onClick:t[3]||(t[3]=r=>e.$refs.date_ds.show()),label:"Date",filled:"",modelValue:i.form.date_ds,"onUpdate:modelValue":t[4]||(t[4]=r=>i.form.date_ds=r),mask:"####-##-##"},{append:l(()=>[s(b,{name:"event",class:"cursor-pointer"},{default:l(()=>[s(re,{ref:"date_ds",cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[s(ie,{minimal:"",modelValue:i.form.date_ds,"onUpdate:modelValue":[t[1]||(t[1]=r=>i.form.date_ds=r),t[2]||(t[2]=r=>e.$refs.date_ds.hide())],mask:"YYYY-MM-DD"},{default:l(()=>[g("div",Se,[V(s(p,{label:"Fermer",color:"primary",flat:""},null,512),[[F]])])]),_:1},8,["modelValue"])]),_:1},512)]),_:1})]),_:1},8,["onKeydown","modelValue"]),s(q,{filled:"",modelValue:i.form.titre,"onUpdate:modelValue":t[5]||(t[5]=r=>i.form.titre=r),clearable:"",label:"Titre","lazy-rules":"",onKeydown:$(o.send,["enter"])},null,8,["modelValue","onKeydown"])]),_:1},512)]),_:1}),s(O,{align:"right"},{default:l(()=>[s(p,{icon:"filter_list",onClick:o.send},{default:l(()=>t[7]||(t[7]=[d("Appliquer")])),_:1},8,["onClick"])]),_:1})]),_:1})}const Pe=E(Ue,[["render",Me]]),Le={emits:["devoir:edit","devoir:remove","devoir:hold"],components:{EditForm:Qe,FilterForm:Pe},data(){return{showMore:!1,isPwd:!0,pass:null,can:!0,globalSettings:null,active:null,show:!1,showReponse:!1,showFilter:!1,title:"Devoir",devoir:null,filterForm:{date_ds:null,titre:null,type:null}}},computed:{...Y({user:"user/user",config:"user/config",current:"user/current",form:"ds/form",settings:"ds/settings",devoirsList:"ds/devoirs",emploi:"profEmploi/data"}),disciplines(){if(this.emploi&&this.emploi.length){let e=null;return this.emploi.reduce((t,i)=>(i.classes&&i.classes.idclasse===this.classe.idclasse&&i.matiere.discipline.length&&i.matiere.discipline[0].iddiscipline!=e&&(t.push(i.matiere.discipline[0]),e=i.matiere.discipline[0].iddiscipline),t),[])}return[]},devoirs(){return this.devoirsList&&this.devoirsList.data?this.devoirsList.data:[]},annee(){if(this.current&&this.current.hasOwnProperty("annee"))return this.current.annee}},methods:{...N({getConfig:"user/getConfig",getDevoirs:"ds/getDevoirs",valider:"ds/valider",getSettings:"ds/getSettings",remove:"ds/remove",setRefresh:"setRefresh"}),LetterAvatar:he,toNow:pe,fileIcon:me,openURL:fe,pjUrl:K,verify(){I.has("dsPass")&&(this.can=!1,j("post","/ds/can",{pass:I.get("dsPass")}).then(e=>{this.can=!1}).catch(()=>{this.can=!0}))},submit(){this.$refs.unlock.validate().then(e=>e?(j("post","/ds/can",{pass:this.pass}).then(({data:t})=>{t&&t.success&&(I.set("dsPass",this.pass),this.can=!1)}).catch(()=>{this.can=!0,this.$q.notify({color:"negative",message:"Mot de passe erroné",position:"bottom",icon:"error_outline",actions:[{label:this.$q.lang.label.close,color:"yellow"}]})}),!1):(this.$q.notify({color:"negative",message:this.$t("stats.fields"),position:"bottom",icon:"error_outline",actions:[{label:this.$q.lang.label.close,color:"yellow"}]}),!1))},typeString(e){if(this.settings&&this.settings.types){let t=this.settings.types.find(i=>i.value===e);if(t)return t.label}return null},hasFilter(){return this.filterForm.classes&&this.filterForm.classes.length||this.filterForm.titre&&this.filterForm.titre!=""||this.filterForm.date_ds&&this.filterForm.date_ds!=""},filterDialog(){console.log("filter"),this.showFilter=!0},devoirEnvoye({isNew:e}){e?this.getDevoirs({page:1,filter:this.filter()}):this.getData(),this.show=!1,this.$q.notify({color:"positive",message:this.$t("stats.success"),position:"bottom",icon:"check",actions:[{label:this.$q.lang.label.close,color:"white"}]})},validate(e){this.valider(e.id).then(()=>{this.getData(),this.$q.notify({color:"positive",message:this.$t("stats.success"),position:"bottom",icon:"check",actions:[{label:this.$q.lang.label.close,color:"white"}]})})},getData(){this.showFilter=!1,this.getDevoirs({page:this.devoirsList.current_page,filter:this.filter()})},filter(){let e={annee:this.annee.idannee};return this.filterForm&&(e={...e,...this.filterForm},e.date_ds&&(e.date=e.date_ds)),e},showDelete(e){this.$q.dialog({title:"Suppression",message:"Supprimer ce devoir?",cancel:!0,ok:{label:"Oui",outline:!0,color:"red"},persistent:!0}).onOk(()=>{this.remove(e).then(t=>{this.getData()})})},reponse(e){this.devoir=e,this.showReponse=!0},edit(e){this.devoir=e,this.showMore=!this.showMore,e.id===this.active?this.active=null:e&&!e.status&&(Object.assign(this.form,e),this.$emit("devoir:edit",{dvr:e,title:"Modifier"}),this.title=this.form.titre,this.form.classes=this.form.classes.map(t=>t.classe_id),this.form.date_ds=T(new Date(this.form.date_ds),"yyyy-MM-dd"),this.show=!0)},toDate(e){return ve.capitalize(T(new Date(e),"E dd MMM yyyy"))},personAvatar(e){return B(e)},sub(e){return this.$cleanHtml(e,{allowedTags:["b","i","em","strong","a"]})}},watch:{annee(){this.getDevoirs({page:1,filter:this.filter()})}},mounted(){this.verify(),this.setTitle("DS"),this.getSettings().then(()=>{this.settings&&this.settings.titre&&this.setTitle(this.settings.titre),this.getDevoirs({page:1,filter:this.filter()})}),this.globalSettings||j("post","/settings").then(e=>{this.globalSettings=e.data}),this.setRefresh(e=>{this.getDevoirs({page:1,filter:this.filter()}),e()})}},Oe={class:"q-pa-lg flex flex-center"},xe={style:{"font-weight":"500"}},Ae={style:{"font-weight":"500"}},Te=["onClick"];function ze(e,t,i,w,a,o){const r=z("ep-pagination"),ae=z("filter-form"),oe=z("ep-footer");return u(),v(D,null,[s(ge,{padding:"",class:"page-content"},{default:l(()=>[g("div",Oe,[e.devoirsList?(u(),h(r,{key:0,modelValue:e.devoirsList.current_page,"onUpdate:modelValue":[t[0]||(t[0]=n=>e.devoirsList.current_page=n),o.getData],max:e.devoirsList.last_page,"direction-links":"","boundary-links":!1,div:"",divClass:"full-width text-center text-white text-bold",dark:"",color:"white",class:"bg-primary full-width",style:{"border-radius":"10rem",height:"30px"}},{content:l(()=>[s(p,{onClick:o.filterDialog,flat:""},{default:l(()=>[o.hasFilter()?(u(),h(C,{key:0,color:"warning",rounded:"",align:"top"})):c("",!0),s(b,{name:"filter_list"}),d(" Page "+f(e.devoirsList.current_page),1)]),_:1},8,["onClick"])]),_:1},8,["modelValue","max","onUpdate:modelValue"])):c("",!0)]),s(Q,{flat:""},{default:l(()=>[s(X,null,{default:l(()=>[s(H),(u(!0),v(D,null,U(o.devoirs,(n,G)=>(u(),v(D,{key:G},[s(k,{clickable:"",style:W({"border-left":"5px solid "+(n.status?"var(--q-positive)":"var(--q-warning)")}),onClick:_=>o.edit(n),active:a.active===n.id},{default:l(()=>[s(y,null,{default:l(()=>[s(m,{style:{"font-weight":"500"}},{default:l(()=>[g("div",null,[s(C,{color:"secondary"},{default:l(()=>[d(f(o.typeString(n.type)),1)]),_:2},1024),d(" "+f(n.titre),1)])]),_:2},1024),s(m,{style:{padding:"12px 0"},lines:"1"},{default:l(()=>[d(f(n.description),1)]),_:2},1024),s(m,{lines:"1"},{default:l(()=>[t[7]||(t[7]=d(" LE: ")),g("span",xe,f(o.toDate(n.date_ds)),1)]),_:2},1024),s(m,{lines:"1"},{default:l(()=>[t[8]||(t[8]=d(" PROF: ")),g("span",Ae,f(n.prof.nom)+" "+f(n.prof.prenom),1)]),_:2},1024),s(m,null,{default:l(()=>[(u(!0),v(D,null,U(n.classes,(_,ne)=>(u(),h(C,{key:"n.id+'-cls-'+icls",color:"blue"},{default:l(()=>[d(f(_.classe.classe_fr),1)]),_:2},1024))),128))]),_:2},1024),n.fichiers.length?(u(),h(m,{key:0,lines:"1"},{default:l(()=>[(u(!0),v(D,null,U(n.fichiers,(_,ne)=>(u(),v("div",{outline:"",color:"grey-9",onClick:ce(Re=>o.openURL(o.pjUrl(_)),["stop"]),class:"ellipsis rounded-borders q-mr-xs q-pa-xs",style:{"max-width":"40%",display:"inline-block",border:"1px solid var(--q-primary)"}},[s(b,{name:"img:"+o.fileIcon(_.fichier),size:"14px"},null,8,["name"]),d(" "+f(_.fichier),1)],8,Te))),256))]),_:2},1024)):c("",!0)]),_:2},1024),s(y,{side:"",top:"",style:{position:"relative"}},{default:l(()=>[s(m,{caption:""},{default:l(()=>[d(f(o.toNow(new Date(n.created_at).getTime())),1)]),_:2},1024),s(m,{caption:""},{default:l(()=>[n.status?(u(),h(C,{key:0,color:"positive"},{default:l(()=>t[9]||(t[9]=[d("Validé")])),_:1})):(u(),h(C,{key:1,color:"warning"},{default:l(()=>t[10]||(t[10]=[d("En cours")])),_:1}))]),_:2},1024),s(m,{caption:""},{default:l(()=>[s(C,{style:W({"background-color":n.matiere.color})},{default:l(()=>[d(f(n.matiere.description),1)]),_:2},1032,["style"])]),_:2},1024),n.status?c("",!0):(u(),h(m,{key:0,style:{"min-height":"32px","min-width":"32px","margin-top":"16px"}},{default:l(()=>[n.status?c("",!0):(u(),h(p,{key:0,onClick:_=>o.validate(n),dense:"",unelevated:"",color:"primary"},{default:l(()=>[s(b,{name:"done"})]),_:2},1032,["onClick"]))]),_:2},1024))]),_:2},1024)]),_:2},1032,["style","onClick","active"]),s(H)],64))),128))]),_:1})]),_:1}),s(R,{modelValue:a.showFilter,"onUpdate:modelValue":t[1]||(t[1]=n=>a.showFilter=n),position:"top"},{default:l(()=>[s(ae,{"global-settings":a.globalSettings,form:a.filterForm,"onDevoir:filter":o.getData},null,8,["global-settings","form","onDevoir:filter"])]),_:1},8,["modelValue"]),s(R,{modelValue:a.showMore,"onUpdate:modelValue":t[2]||(t[2]=n=>a.showMore=n)},{default:l(()=>[s(Q,{style:{"min-width":"350px"}},{default:l(()=>[s(A,{class:P({"bg-secondary":!0,"text-white":!0,"shadow-2":!0})},{default:l(()=>[V(s(p,{flat:"",dense:"",icon:"arrow_back"},null,512),[[F]]),s(x,null,{default:l(()=>t[11]||(t[11]=[d(" Détails du devoir ")])),_:1})]),_:1}),a.devoir?(u(),h(L,{key:0},{default:l(()=>[s(X,null,{default:l(()=>[s(k,null,{default:l(()=>[s(y,null,{default:l(()=>[s(m,{caption:""},{default:l(()=>t[12]||(t[12]=[d("Titre")])),_:1}),s(m,null,{default:l(()=>[d(f(a.devoir.titre),1)]),_:1})]),_:1})]),_:1}),s(k,null,{default:l(()=>[s(y,null,{default:l(()=>[s(m,{caption:""},{default:l(()=>t[13]||(t[13]=[d("Description")])),_:1}),s(m,null,{default:l(()=>[g("pre",null,"                    "+f(a.devoir.description)+`
                  `,1)]),_:1})]),_:1})]),_:1}),s(k,null,{default:l(()=>[s(y,null,{default:l(()=>[s(m,{caption:""},{default:l(()=>t[14]||(t[14]=[d("Date")])),_:1}),s(m,null,{default:l(()=>[d(f(o.toDate(a.devoir.date_ds)),1)]),_:1})]),_:1})]),_:1}),s(k,null,{default:l(()=>[s(y,null,{default:l(()=>[s(m,{caption:""},{default:l(()=>t[15]||(t[15]=[d("Matière")])),_:1}),s(m,null,{default:l(()=>[d(f(a.devoir.matiere.description),1)]),_:1})]),_:1})]),_:1}),s(k,null,{default:l(()=>[s(y,null,{default:l(()=>[s(m,{caption:""},{default:l(()=>t[16]||(t[16]=[d("Professeur")])),_:1}),s(m,null,{default:l(()=>[d(f(a.devoir.prof.nom)+" "+f(a.devoir.prof.prenom),1)]),_:1})]),_:1})]),_:1}),a.devoir.fichiers&&a.devoir.fichiers.length?(u(),h(k,{key:0},{default:l(()=>[s(y,null,{default:l(()=>[s(m,{caption:""},{default:l(()=>t[17]||(t[17]=[d("Fichiers")])),_:1}),(u(!0),v(D,null,U(a.devoir.fichiers,n=>(u(),v("div",{key:n.id},[s(p,{flat:"",color:"primary",onClick:G=>o.openURL(o.pjUrl(n))},{default:l(()=>[s(b,{name:"img:"+o.fileIcon(n.fichier),size:"18px"},null,8,["name"]),d(" "+f(n.fichier),1)]),_:2},1032,["onClick"])]))),128))]),_:1})]),_:1})):c("",!0)]),_:1})]),_:1})):c("",!0),s(O,{align:"right"},{default:l(()=>[V(s(p,{flat:"",label:"Fermer",color:"primary"},null,512),[[F]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(R,{modelValue:a.can,"onUpdate:modelValue":t[6]||(t[6]=n=>a.can=n),maximized:"",persistent:""},{default:l(()=>[s(Q,null,{default:l(()=>[s(A,{class:P({"bg-secondary":!0,"text-white":!0,"shadow-2":!0})},{default:l(()=>[s(p,{flat:"",dense:"",icon:"arrow_back",onClick:t[3]||(t[3]=n=>e.go("/"))}),s(x)]),_:1}),s(L,null,{default:l(()=>[s(J,{ref:"unlock",onSubmit:o.submit},{default:l(()=>[s(q,{modelValue:a.pass,"onUpdate:modelValue":t[5]||(t[5]=n=>a.pass=n),type:a.isPwd?"password":"text",label:"Code d'activation",name:"password",rules:[n=>!!n||"Champ requis"]},{prepend:l(()=>[s(b,{name:"password",size:"sm"})]),append:l(()=>[s(b,{name:a.isPwd?"visibility_off":"visibility",class:"cursor-pointer",onClick:t[4]||(t[4]=n=>a.isPwd=!a.isPwd)},null,8,["name"])]),_:1},8,["modelValue","type","rules"])]),_:1},8,["onSubmit"])]),_:1}),s(O,{align:"right"},{default:l(()=>[s(p,{color:"primary",onClick:o.submit},{default:l(()=>t[18]||(t[18]=[d(" Envoyer")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),s(oe,{to:"#footer-portal"})],64)}const ht=E(Le,[["render",ze]]);export{ht as default};
