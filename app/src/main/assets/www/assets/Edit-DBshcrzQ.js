import{_ as b,aO as _,aP as V,c5 as C,c6 as Q,B as w,A as n,C as I,Q as q,S as D,a6 as u,a5 as l,aE as k,aF as B,ah as E,a2 as m,aG as G,a3 as g,aC as S}from"./index-Bl2lQPd7.js";import{Q as $}from"./QForm-Dk45GsL9.js";const h={__name:"Edit",setup(F){const d=_(),c=V(),f=C(),i=Q(),o=w(()=>!i.params.id),s=n(!1),p=n(null),t=n({date_note:"",idmatiere:null,idclasse:null}),y=async()=>{if(!o.value)try{s.value=!0;const r=await c.dispatch("grades/fetchGradeById",i.params.id);t.value={...r}}catch{d.notify({type:"negative",message:"Erreur lors du chargement de la note"}),f.go(-1)}finally{s.value=!1}},v=async()=>{if(!await p.value.validate()){d.notify({type:"negative",message:"Veuillez corriger les erreurs du formulaire"});return}try{s.value=!0;const r=o.value?"grades/createGrade":"grades/updateGrade",e={...t.value,...o.value?{}:{idgrade:i.params.id}};await c.dispatch(r,e),d.notify({type:"positive",message:`Note ${o.value?"créée":"modifiée"} avec succès`}),f.go(-1)}catch(r){d.notify({type:"negative",message:`Erreur lors de l'enregistrement de la note: ${r.message}`})}finally{s.value=!1}};return I(()=>{y()}),(r,e)=>(D(),q(S,null,{default:u(()=>[l(k,{class:"edit-card"},{default:u(()=>[l(B,null,{default:u(()=>[l($,{onSubmit:E(v,["prevent"]),class:"q-gutter-md",ref_key:"editFormRef",ref:p},{default:u(()=>[l(m,{modelValue:t.value.date_note,"onUpdate:modelValue":e[0]||(e[0]=a=>t.value.date_note=a),type:"date",label:"Date de la note",filled:"",rules:["required"]},null,8,["modelValue"]),l(m,{modelValue:t.value.idmatiere,"onUpdate:modelValue":e[1]||(e[1]=a=>t.value.idmatiere=a),type:"number",label:"ID Matière",filled:"",rules:["required",a=>a>0||"ID invalide"]},null,8,["modelValue","rules"]),l(m,{modelValue:t.value.idclasse,"onUpdate:modelValue":e[2]||(e[2]=a=>t.value.idclasse=a),type:"number",label:"ID Classe",filled:"",rules:["required",a=>a>0||"ID invalide"]},null,8,["modelValue","rules"])]),_:1},512)]),_:1}),l(G,{align:"right",class:"bg-white q-gutter-sm"},{default:u(()=>[l(g,{flat:"",label:"Annuler",color:"grey",disable:s.value,onClick:e[3]||(e[3]=a=>r.$router.go(-1))},null,8,["disable"]),l(g,{flat:"",type:"submit",label:o.value?"Créer":"Modifier",color:"primary",loading:s.value,onClick:v},null,8,["label","loading"])]),_:1})]),_:1})]),_:1}))}},x=b(h,[["__scopeId","data-v-4538a18a"]]);export{x as default};
