import{_ as j,ar as K,aq as X,as as Y,at as Z,ag as w,a4 as _,S as a,Q as d,R as f,a5 as e,a6 as t,ad as c,ab as u,a3 as m,a7 as Q,a8 as n,a9 as v,aa as x,av as D,aw as q,ax as b,ay as C,af as A,az as $,aA as ee,aD as E,h as te,aN as N,aB as M,aJ as le}from"./index-Bl2lQPd7.js";import{Q as k,a as p}from"./QItem-De3v03wU.js";import{Q as y}from"./QList-CMzNTEGD.js";import{Q as S}from"./QMenu-BNr9Tzvf.js";import{Q as P}from"./QToolbarTitle-C8APieXG.js";import{Q as B}from"./QBadge-Bjfo5tRO.js";import{Q as V}from"./QItemLabel-BkJiB6aE.js";import{Q as se}from"./QExpansionItem-EMhshZ_3.js";import{Q as oe}from"./QScrollArea-DbARZhEV.js";import{_ as re,Q as ae}from"./SchoolSwitcher-D06IRcd0.js";import{Q as ie}from"./QToolbar-DR-_wX4W.js";import{Q as ne}from"./QFooter-BqOQs2Wv.js";import{Q as ue}from"./QPullToRefresh-BShZwV52.js";import{C as z}from"./ClosePopup-BY_YGFBZ.js";import{E as de}from"./Header-iKAj_IF4.js";import{N as fe}from"./Notifications-DUxCRqy9.js";import{_ as ce}from"./Espace-7ToSYTXU.js";import{C as me,S as pe}from"./Contact-BnHMrRuo.js";import{s as F}from"./notif-Ca_8-ZkB.js";import"./position-engine-o8Q2RudZ.js";import"./selection-DaBtDCZ0.js";import"./QSlideTransition-CrdUnXBf.js";import"./TouchPan-jBhMORlX.js";import"./touch-BjYP5sR0.js";import"./format-IcNrutKL.js";import"./composables-CAkrP3jA.js";import"./QBanner-xBGiroIy.js";import"./QPageSticky-adQ0nSeI.js";import"./QHeader-B4MlZ-LM.js";import"./QSpace-CKKoNTi_.js";import"./groupBy-BgHPVcz-.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./_curry1-CPMemvwC.js";import"./_xfBase-ZXVHuZFu.js";import"./_reduce-BZMr9wpn.js";import"./_isArrayLike-B3kKjEvQ.js";import"./index-Dx01H97j.js";import"./index-CbPSoDvq.js";import"./QImg-BMvxJu3S.js";const he={name:"MyLayout",data(){return{isFullscreen:!1,settingeDialog:!1,showNotifs:!1,showSortie:!1,showContact:!1,drawerOpen:this.$q.platform.is.desktop}},components:{EpHeader:de,Notifications:fe,Sortie:pe,Contact:me,EspaceSwitcher:ce,SchoolSwitcher:re},computed:{...Z({user:"user/user",config:"user/config",links:"user/nav",current:"user/current",notificationCounter:"notification/counter",darkMode:"darkMode",title:"title",footer:"footer",refreshFunction:"refresh"}),eleve(){if(this.current&&this.current.hasOwnProperty("eleve"))return this.current.eleve},annee(){if(this.current&&this.current.hasOwnProperty("annee"))return this.current.annee},dark:{get(){return this.darkMode},set(r){this.toggleDarkMode()}}},methods:{...Y({logout:"user/logout",nav:"user/nav",setDefaults:"user/setDefaults",toggleEleve:"user/setEleve",togglAnnee:"user/setAnnee",getEmploi:"emploi/getData",getDevoirs:"devoirs/getDevoirs",setCounter:"notification/setCounter",toggleDarkMode:"toggleDarkMode"}),isDev:X,openURL:K,refresh(r){this.refreshFunction?this.refreshFunction(r):r()},clearNotifCounter(){this.setCounter(0)},subscribeAll(r){if(this.$q.platform.is.cordova){let s="ecoleplus_"+r;F(s+"_parent"),F(s+"_"+this.user.idpers),this.config.meta.eleves.forEach(O=>{F(s+"_"+O.idpers)})}},setEleve(r){this.toggleEleve(r),this.go("/parent")},setAnnee(r){this.togglAnnee(r),this.go("/parent")},avatar(){return M(this.user)},personAvatar(r){return M(r)},deconnexion(){this.logout(),this.$router.push("/login")},minimize(){},maximize(){},fullscreen(){this.$q.electron.remote.BrowserWindow.getFocusedWindow().setFullScreen(this.isFullscreen=!this.isFullscreen)},close(){}},watch:{annee(){this.getEmploi(this.annee),this.getDevoirs({page:1,filter:{annee:this.annee.idannee,classe:this.annee.pivot.idclasse}})}},created(){le("parent")},mounted(){this.canAccess(this.config),this.nav(),this.setDefaults(this.config),this.subscribeAll(te),N.length&&(this.$router.push(N[0]),N.splice(0,N.length))}},_e=["src"],ve=["src"],ge={class:"col-xs-10",style:{position:"relative"}},we={class:"absolute-top text-white bg1",style:{height:"150px",overflow:"hidden"}},be={class:"absolute-bottom text-center"},ke=["src"],Ce={class:"text-weight-bold text-white text-shadow q-mb-xl"},ye={class:"absolute-bottom text-left q-pa-sm"},Qe=["src"],xe={class:"q-ml-sm"},De=["src"],qe={class:"col-xs-2 bg-white text-dark q-pt-lg q-pb-lg q-pr-xs",style:{position:"relative"}},Ae={class:"flex flex-center full-width"},Ne={class:"flex flex-center full-width"},Se={class:"flex flex-center full-width q-mt-sm"},Ve={class:"flex flex-center full-width q-mt-sm"},Ee={class:"absolute-bottom"},ze={class:"flex flex-center full-width"};function Fe(r,s,R,O,i,o){const I=w("ep-header"),L=w("espace-switcher"),U=w("school-switcher"),T=w("router-view"),H=w("notifications"),W=w("sortie"),G=w("contact");return a(),_(v,null,[r.user?(a(),d(ee,{key:0,view:"hhr lpR fFr",class:A({page:!0})},{default:t(()=>[e(ue,{onRefresh:o.refresh},{default:t(()=>[e(I,null,{toolbar:t(()=>[o.eleve?(a(),d(m,{key:0,flat:""},{default:t(()=>[e(Q,{size:"45px"},{default:t(()=>[n("img",{src:o.personAvatar(o.eleve)},null,8,_e)]),_:1}),e(S,null,{default:t(()=>[e(y,{flat:""},{default:t(()=>[(a(!0),_(v,null,x(r.config.meta.eleves,(l,g)=>D((a(),d(k,{clickable:"",key:g,onClick:h=>o.setEleve(l),active:o.eleve.idpers===l.idpers},{default:t(()=>[e(p,{avatar:""},{default:t(()=>[e(Q,null,{default:t(()=>[n("img",{src:o.personAvatar(l)},null,8,ve)]),_:2},1024)]),_:2},1024),e(p,null,{default:t(()=>[c(u(l.nom)+" "+u(l.prenom),1)]),_:2},1024)]),_:2},1032,["onClick","active"])),[[z],[q]])),128))]),_:1})]),_:1})]),_:1})):f("",!0),o.annee?(a(),d(m,{key:1,flat:"",icon:"pending_actions",dark:""},{default:t(()=>[c(u(o.annee.description)+" ",1),e(S,null,{default:t(()=>[e(y,{link:""},{default:t(()=>[(a(!0),_(v,null,x(o.eleve.annees,(l,g)=>D((a(),d(k,{clickable:"",key:g,onClick:h=>o.setAnnee(l),active:o.annee.idannee===l.idannee},{default:t(()=>[e(p,null,{default:t(()=>[c(u(l.description)+" - "+u(l.pivot.classes.classe_fr),1)]),_:2},1024)]),_:2},1032,["onClick","active"])),[[z],[q]])),128))]),_:1})]),_:1})]),_:1})):f("",!0),e(P),e(m,{onClick:s[0]||(s[0]=l=>r.go("/parent")),flat:"",round:"",dense:"",icon:"icon_home",class:"q-mr-xs"}),e(m,{flat:"",round:"",dense:"",icon:"icon_menu_burger",onClick:s[1]||(s[1]=l=>i.drawerOpen=!i.drawerOpen),"aria-label":"Menu"},{default:t(()=>[r.notificationCounter>0?(a(),d(B,{key:0,color:"warning",floating:""},{default:t(()=>[c(u(r.notificationCounter),1)]),_:1})):f("",!0)]),_:1})]),title:t(()=>[c(u(r.title),1)]),_:1}),e(ae,{modelValue:i.drawerOpen,"onUpdate:modelValue":s[6]||(s[6]=l=>i.drawerOpen=l),side:"right",dark:"",elevated:"",class:"bg-secondary row"},{default:t(()=>[n("div",ge,[e(oe,{style:{height:"calc(100% - 150px)","margin-top":"150px"}},{default:t(()=>[e(y,{bordered:""},{default:t(()=>[(a(!0),_(v,null,x(r.links,(l,g)=>(a(),_(v,null,[l.haschildren&&l.items.length?(a(),d(se,{key:0,label:l.label},{default:t(()=>[e(y,null,{default:t(()=>[(a(!0),_(v,null,x(l.items,(h,J)=>(a(),_(v,null,[o.isDev()||!h.disable?D((a(),d(k,{clickable:"",to:h.to,key:J,disable:o.isDev()?!1:h.disable,exact:!h.hasOwnProperty("haschildren")},{default:t(()=>[e(p,null,{default:t(()=>[e(V,null,{default:t(()=>[c(u(h.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to","disable","exact"])),[[q]]):f("",!0)],64))),256))]),_:2},1024)]),_:2},1032,["label"])):o.isDev()||!l.disable?D((a(),d(k,{clickable:"",to:l.to,key:g,disable:o.isDev()?!1:l.disable,exact:!l.hasOwnProperty("haschildren")},{default:t(()=>[e(p,null,{default:t(()=>[e(V,null,{default:t(()=>[c(u(l.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to","disable","exact"])),[[q]]):f("",!0),l.disable?f("",!0):(a(),d(b,{key:2}))],64))),256))]),_:1})]),_:1}),n("div",we,[n("div",be,[e(Q,{size:"56px",class:"q-mb-sm"},{default:t(()=>[n("img",{src:o.avatar(r.user)},null,8,ke),e(S,null,{default:t(()=>[e(y,{link:""},{default:t(()=>[e(k,{to:"/personnel",clickable:""},{default:t(()=>[e(p,{side:""},{default:t(()=>[e(C,{name:"account_circle"})]),_:1}),e(p,null,{default:t(()=>[e(V,null,{default:t(()=>s[12]||(s[12]=[c(" Profil ")])),_:1})]),_:1})]),_:1}),e(b),e(k,{onClick:o.deconnexion,clickable:""},{default:t(()=>[e(p,{side:""},{default:t(()=>[e(C,{name:"power_settings_new"})]),_:1}),e(p,null,{default:t(()=>[e(V,null,{default:t(()=>s[13]||(s[13]=[c(" DÃ©connexion ")])),_:1})]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),n("div",Ce,u(r.user.nom)+" "+u(r.user.prenom),1),n("div",ye,[o.eleve?(a(),d(m,{key:0,flat:"",class:""},{default:t(()=>[e(Q,{size:"xs"},{default:t(()=>[n("img",{src:o.personAvatar(o.eleve)},null,8,Qe)]),_:1}),n("span",xe,u(o.eleve.nom)+" "+u(o.eleve.prenom),1),e(S,null,{default:t(()=>[e(y,{flat:""},{default:t(()=>[(a(!0),_(v,null,x(r.config.meta.eleves,(l,g)=>D((a(),d(k,{clickable:"",key:g,onClick:h=>o.setEleve(l),active:o.eleve.idpers===l.idpers},{default:t(()=>[e(p,{avatar:""},{default:t(()=>[e(Q,null,{default:t(()=>[n("img",{src:o.personAvatar(l)},null,8,De)]),_:2},1024)]),_:2},1024),e(p,null,{default:t(()=>[c(u(l.nom)+" "+u(l.prenom),1)]),_:2},1024)]),_:2},1032,["onClick","active"])),[[z],[q]])),128))]),_:1})]),_:1})]),_:1})):f("",!0)])])])]),n("div",qe,[e(m,{class:"full-width q-mb-sm",flat:"",onClick:s[2]||(s[2]=l=>i.drawerOpen=!i.drawerOpen),"aria-label":"Menu"},{default:t(()=>[e(C,{name:"icon_menu_burger"})]),_:1}),n("div",Ae,[e(b,{style:{width:"50%"}})]),e(m,{class:A({"full-width":!0,"q-mt-sm":!0,greyscale:r.notificationCounter==0}),size:"lg",flat:"",dense:"",onClick:s[3]||(s[3]=l=>i.showNotifs=!i.showNotifs),"aria-label":"Menu"},{default:t(()=>[r.notificationCounter>0?(a(),d(B,{key:0,color:"warning",floating:""},{default:t(()=>[c(u(r.notificationCounter),1)]),_:1})):f("",!0),s[14]||(s[14]=n("img",{src:"leaf.svg",class:"full-width"},null,-1))]),_:1},8,["class"]),n("div",Ne,[e(b,{style:{width:"50%"}})]),e(m,{flat:"",class:A({"full-width":!0,"q-mt-sm":!0}),onClick:s[4]||(s[4]=l=>i.showSortie=!i.showSortie)},{default:t(()=>[e(C,{name:"icon_qr_code"})]),_:1}),n("div",Se,[e(b,{style:{width:"50%"}})]),e(m,{flat:"",class:A({"full-width":!0,"q-mt-sm":!0}),onClick:s[5]||(s[5]=l=>i.showContact=!i.showContact)},{default:t(()=>[e(C,{name:"icon_uniF2C3"})]),_:1}),n("div",Ve,[e(b,{style:{width:"50%"}})]),e(L),e(U),n("div",Ee,[n("div",ze,[e(b,{style:{width:"50%"}})]),e(m,{onClick:o.deconnexion,color:"red",flat:"",size:"lg",class:"full-width"},{default:t(()=>[e(C,{name:"power_settings_new"})]),_:1},8,["onClick"])])])]),_:1},8,["modelValue"]),e($,null,{default:t(()=>[o.annee?(a(),d(T,{key:0})):f("",!0)]),_:1}),r.footer?(a(),d(ne,{key:0,class:"bg-secondary"},{default:t(()=>[e(ie,null,{default:t(()=>[e(P,null,{default:t(()=>[e(m,{icon:"icon_retour_mobile",flat:"",onClick:s[7]||(s[7]=l=>r.$router.go(-1))})]),_:1}),s[15]||(s[15]=n("div",{id:"footer-portal"},null,-1))]),_:1})]),_:1})):f("",!0)]),_:1},8,["onRefresh"])]),_:1})):f("",!0),e(E,{modelValue:i.showNotifs,"onUpdate:modelValue":s[9]||(s[9]=l=>i.showNotifs=l),position:"right",maximized:"",onHide:o.clearNotifCounter},{default:t(()=>[e(H,{"onNotif:close":s[8]||(s[8]=l=>{i.showNotifs=!1,i.drawerOpen=!1})})]),_:1},8,["modelValue","onHide"]),e(E,{modelValue:i.showSortie,"onUpdate:modelValue":s[10]||(s[10]=l=>i.showSortie=l),position:"right",maximized:""},{default:t(()=>[e(W)]),_:1},8,["modelValue"]),e(E,{modelValue:i.showContact,"onUpdate:modelValue":s[11]||(s[11]=l=>i.showContact=l),position:"right",maximized:""},{default:t(()=>[e(G)]),_:1},8,["modelValue"])],64)}const bt=j(he,[["render",Fe]]);export{bt as default};
