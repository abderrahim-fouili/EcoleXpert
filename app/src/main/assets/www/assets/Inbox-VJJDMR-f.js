import{Q as y}from"./QImg-BMvxJu3S.js";import{_ as w,aY as x,b8 as Q,b9 as C,b2 as I,ba as D,as as M,at as V,ag as h,a4 as d,S as i,Q as u,R as c,a5 as t,a6 as a,ad as n,ab as l,a9 as g,aa as _,av as U,a7 as A,a8 as B,af as b,ah as N,ay as q,aw as P,aE as R,be as T,aB as j}from"./index-Bl2lQPd7.js";import{Q as S,a as p}from"./QItem-De3v03wU.js";import{Q as z}from"./QBadge-Bjfo5tRO.js";import{Q as o}from"./QItemLabel-BkJiB6aE.js";import{Q as E}from"./QList-CMzNTEGD.js";import{q as H}from"./date-C1Mon-Jj.js";import"./format-IcNrutKL.js";const O={computed:{...V({user:"user/user",config:"user/config",links:"user/nav",current:"user/current",messagesList:"message/inbox",darkMode:"darkMode"}),messages(){return this.messagesList&&this.messagesList.data?this.messagesList.data:[]},classe(){if(this.current&&this.current.hasOwnProperty("classe"))return this.current.classe},annee(){if(this.current&&this.current.hasOwnProperty("annee"))return this.current.annee},dark:{get(){return this.darkMode},set(s){this.toggleDarkMode()}}},methods:{...M({getConfig:"user/getConfig",getMessages:"message/getInbox"}),LetterAvatar:D,toNow:I,fileIcon:C,openURL:Q,pjUrl:x,personAvatar(s){return j(s)},getData(){this.messagesList?this.getMessages({page:this.messagesList.current_page,filter:this.filter()}):this.getMessages({page:1,filter:this.filter()})},filter(){return null},sub(s){return T(this.$cleanHtml(s,{allowedTags:[]}))},date(s){return H.formatDate(s*1e3)}},mounted(){this.getData()}},F=["onClick"];function G(s,f,Y,J,K,r){const k=h("ep-pagination"),L=h("ep-portal");return i(),d(g,null,[s.messagesList?(i(),u(L,{key:0,to:"#pagination-portal"},{default:a(()=>[s.messagesList&&s.messagesList.current_page?(i(),u(k,{key:0,modelValue:s.messagesList.current_page,"onUpdate:modelValue":[f[0]||(f[0]=e=>s.messagesList.current_page=e),r.getData],max:s.messagesList.last_page,"direction-links":"","boundary-links":!1,div:"",divClass:"full-width text-center text-white text-bold",dark:"",color:"white",class:"bg-primary full-width",style:{"border-radius":"10rem",height:"30px"}},{content:a(()=>[n(" Page "+l(s.messagesList.current_page),1)]),_:1},8,["modelValue","max","onUpdate:modelValue"])):c("",!0)]),_:1})):c("",!0),t(R,{style:{margin:"0 -8px"},flat:""},{default:a(()=>[t(E,null,{default:a(()=>[(i(!0),d(g,null,_(r.messages,(e,v)=>U((i(),u(S,{key:v,clickable:"",to:"/admin/messages/view/"+e.id},{default:a(()=>[t(p,{avatar:""},{default:a(()=>[t(A,null,{default:a(()=>[t(y,{src:r.personAvatar(e.sender),"placeholder-src":r.LetterAvatar(e.sender.nom),ratio:"1"},null,8,["src","placeholder-src"])]),_:2},1024)]),_:2},1024),t(p,null,{default:a(()=>[t(o,{lines:"1"},{default:a(()=>[t(z,{transparent:"",color:"secondary"},{default:a(()=>[n(l(e.type_sender),1)]),_:2},1024),B("span",{class:b({"text-weight-bold":!e.etat.length})}," Â "+l(e.sender.nom)+" "+l(e.sender.prenom),3)]),_:2},1024),t(o,{lines:"1",class:b({"text-weight-bold":!e.etat.length})},{default:a(()=>[n(l(e.objet),1)]),_:2},1032,["class"]),t(o,{caption:"",lines:"1"},{default:a(()=>[n(l(r.sub(e.message)),1)]),_:2},1024),e.fichiers.length?(i(),u(o,{key:0,lines:"1"},{default:a(()=>[(i(!0),d(g,null,_(e.fichiers,(m,W)=>(i(),d("div",{outline:"",color:"grey-9",onClick:N(X=>r.openURL(r.pjUrl(m)),["prevent"]),class:"ellipsis rounded-borders q-mr-xs q-pa-xs",style:{"max-width":"40%",display:"inline-block",border:"1px solid var(--q-primary)"}},[t(q,{name:"img:"+r.fileIcon(m.fichier),size:"14px"},null,8,["name"]),n(" "+l(m.fichier),1)],8,F))),256))]),_:2},1024)):c("",!0)]),_:2},1024),t(p,{side:"",top:""},{default:a(()=>[t(o,{caption:""},{default:a(()=>[n(l(r.toNow(e.created_at*1e3)),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to"])),[[P]])),128))]),_:1})]),_:1})],64)}const le=w(O,[["render",G]]);export{le as default};
