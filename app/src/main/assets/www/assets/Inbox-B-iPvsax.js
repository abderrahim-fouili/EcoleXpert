import{Q as _}from"./QImg-BMvxJu3S.js";import{Q as b}from"./QBadge-Bjfo5tRO.js";import{_ as v,aY as k,b8 as x,b9 as Q,b2 as w,ba as y,as as L,at as I,Q as c,S as i,a6 as a,a5 as t,a4 as u,a9 as f,aa as p,av as M,a7 as C,ad as o,ab as n,R as A,a8 as B,af as g,ah as N,ay as q,aw as D,aE as U,aB as H}from"./index-Bl2lQPd7.js";import{Q as R,a as m}from"./QItem-De3v03wU.js";import{Q as l}from"./QItemLabel-BkJiB6aE.js";import{Q as T}from"./QList-CMzNTEGD.js";import{q as V}from"./date-C1Mon-Jj.js";import"./format-IcNrutKL.js";const j={computed:{...I({user:"user/user",config:"user/config",links:"user/nav",current:"user/current",messagesList:"message/inbox",darkMode:"darkMode"}),messages(){return this.messagesList&&this.messagesList.data?this.messagesList.data:[]},eleve(){if(this.current&&this.current.hasOwnProperty("eleve"))return this.current.eleve},annee(){if(this.current&&this.current.hasOwnProperty("annee"))return this.current.annee},dark:{get(){return this.darkMode},set(s){this.toggleDarkMode()}}},methods:{...L({getConfig:"user/getConfig",getMessages:"message/getInbox"}),LetterAvatar:y,toNow:w,fileIcon:Q,openURL:x,pjUrl:k,personAvatar(s){return H(s)},sub(s){return this.$cleanHtml(s,{allowedTags:["b","i","em","strong","a"]})},date(s){return V.formatDate(s*1e3)}},mounted(){this.getMessages({page:1,filter:{kids:this.config.meta.eleves.map(s=>s.idpers)}})}},P=["onClick"];function S(s,z,E,O,F,r){return i(),c(U,{style:{margin:"0 -8px"},flat:""},{default:a(()=>[t(T,null,{default:a(()=>[(i(!0),u(f,null,p(r.messages,(e,h)=>M((i(),c(R,{key:h,clickable:"",to:"/messages/view/"+e.id},{default:a(()=>[t(m,{avatar:""},{default:a(()=>[t(C,null,{default:a(()=>[t(_,{src:r.personAvatar(e.sender),"placeholder-src":r.LetterAvatar(e.sender.nom)},null,8,["src","placeholder-src"]),t(b,{floating:"",transparent:"",color:"secondary"},{default:a(()=>[o(n(e.type_sender),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(m,null,{default:a(()=>[t(l,{lines:"1"},{default:a(()=>[B("span",{class:g({"text-weight-bold":!e.etat.length})},n(e.sender.nom)+" "+n(e.sender.prenom),3)]),_:2},1024),t(l,{lines:"1",class:g({"text-weight-bold":!e.etat.length})},{default:a(()=>[o(n(e.objet),1)]),_:2},1032,["class"]),t(l,{caption:"",lines:"1",innerHTML:r.sub(e.message)},null,8,["innerHTML"]),e.fichiers.length?(i(),c(l,{key:0,lines:"1"},{default:a(()=>[(i(!0),u(f,null,p(e.fichiers,(d,G)=>(i(),u("div",{outline:"",color:"grey-9",onClick:N(Y=>r.openURL(r.pjUrl(d)),["prevent"]),class:"ellipsis rounded-borders q-mr-xs q-pa-xs",style:{"max-width":"40%",display:"inline-block",border:"1px solid var(--q-primary)"}},[t(q,{name:"img:"+r.fileIcon(d.fichier),size:"14px"},null,8,["name"]),o(" "+n(d.fichier),1)],8,P))),256))]),_:2},1024)):A("",!0)]),_:2},1024),t(m,{side:"",top:""},{default:a(()=>[t(l,{caption:""},{default:a(()=>[o(n(r.toNow(e.created_at*1e3)),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to"])),[[D]])),128))]),_:1})]),_:1})}const te=v(j,[["render",S]]);export{te as default};
