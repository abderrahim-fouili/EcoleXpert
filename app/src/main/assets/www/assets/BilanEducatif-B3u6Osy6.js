import{Q as Le}from"./QSelect-DchnWyXK.js";import{Q as K}from"./QImg-BMvxJu3S.js";import{_ as ne,aO as ee,aP as te,B as k,a4 as Q,S as s,a5 as e,a6 as t,Q as p,R as A,af as se,av as W,a3 as X,ad as o,ab as n,aF as le,aS as r,a8 as T,a7 as U,ay as P,a9 as L,aa as Y,aE as G,aD as H,ck as be,A as j,bd as F,dk as ve,C as Se,ac as fe,b3 as me,aB as Qe,Y as Ne,ag as je,ax as Fe,aC as Oe}from"./index-Bl2lQPd7.js";import{Q as I,a as g}from"./QItem-De3v03wU.js";import{Q as c}from"./QItemLabel-BkJiB6aE.js";import{Q as ae}from"./QList-CMzNTEGD.js";import{Q as re}from"./QToolbarTitle-C8APieXG.js";import{Q as ie}from"./QToolbar-DR-_wX4W.js";import{C as Z}from"./ClosePopup-BY_YGFBZ.js";import{u as ge,a as he,b as ye,c as xe,H as we,cn as ke}from"./index.esm.min-FpMw1SSI.js";import{g as ue,a as Ue,p as de}from"./groupBy-BPtQCKGy.js";import{s as Pe,a as ce,i as Re,b as qe,c as Me,d as Te}from"./index-BlE9ZCrH.js";import{i as Ce}from"./install-C7aL04A7.js";import{b as Ye}from"./install-Dh964sWS.js";import{a as $e}from"./install-qCEEq-uE.js";import{i as Ve}from"./installSVGRenderer-BO49usYp.js";import{Q as _e}from"./QBadge-Bjfo5tRO.js";import{f as De}from"./index-C9ZTL5MN.js";import{Q as Je}from"./QSpace-CKKoNTi_.js";import{Q as ze}from"./QChip-C9OfA2gn.js";import"./QMenu-BNr9Tzvf.js";import"./position-engine-o8Q2RudZ.js";import"./selection-DaBtDCZ0.js";import"./rtl-DFPa-2ov.js";import"./format-IcNrutKL.js";import"./_xfBase-4bk-g_Vj.js";import"./index-BXMW6yyY.js";import"./index-CbPSoDvq.js";const He={class:"row q-col-gutter-sm"},Ke={class:"col-md-3 col-sm-12 col-6"},Ge={class:"col-md-3 col-sm-12 col-6"},We={__name:"Details",props:["data","eleve","classe"],setup(x){ge([he,ye,xe,Ce,Ye,$e,Ve]),be(ke,"light");const m=x;ee();const S=te();k(()=>S.getters["user/current"]),k(()=>S.getters["stats/notes"]);const V=k(()=>{let u=m.data.eleve.find(l=>l.id===m.data.data.id);return ue(l=>l.idperiode+"_"+l.numero,u.data)}),v=k(()=>{let u=m.data.classe.find(l=>l.id===m.data.data.id);return ue(l=>l.idperiode+"_"+l.numero,u.data)}),i=Pe(Ue("id")),b=k(()=>{let u=Object.keys(V.value).map(l=>({id:l,label:V.value[l][0].periodes.periode_fr+" - C"+V.value[l][0].numero,data:V.value[l]}));return i(u)}),B=k(()=>{let u=Object.keys(v.value).map(l=>({id:l,label:v.value[l][0].periodes.periode_fr+" - C"+v.value[l][0].numero,data:v.value[l]}));return i(u)}),C=k(()=>({tooltip:{trigger:"item"},grid:{left:0,right:0},legend:{center:"top",data:[m.eleve.nom+" "+m.eleve.prenom,m.classe.classe_fr]},xAxis:{type:"category",data:q.value},yAxis:{type:"value",show:!1},series:[{data:N.value,type:"line",name:m.eleve.nom+" "+m.eleve.prenom,color:"#32D305"},{data:z.value,type:"line",name:m.classe.classe_fr,color:"#07331B"}]})),q=k(()=>M().map(u=>u.label)),N=k(()=>M().map(u=>u.data.toFixed(2))),z=k(()=>{let u=M(!0);return M().map(l=>{let f=u.find(w=>w.id===l.id);return f?f.data.toFixed(2):null})});function M(u){let l=null;return u?l=B.value:l=b.value,l.map(f=>{let w=de("notes_personnes",f.data).map($=>$.length?ce(de("note",$))/$.length:0);return w.length?w=ce(w)/w.length:w=0,{id:f.id,label:f.label,data:w}})}function a(u){return ce(de("note",u))}function y(){let u=0,l=null;for(let f=0;f<b.value.length;f++){const w=b.value[f];for(let $=0;$<w.data.length;$++){const O=w.data[$];let J=a(O.notes_personnes);J>=u&&(l={data:O,note:J},u=J)}}return l}function d(){let u=100,l=null;for(let f=0;f<b.value.length;f++){const w=b.value[f];for(let $=0;$<w.data.length;$++){const O=w.data[$];let J=a(O.notes_personnes);J<=u&&(l={data:O,note:J},u=J)}}return l}function D(u){return u.data.matieres.matiere_fr}return(u,l)=>(s(),Q(L,null,[e(G,{style:{"min-width":"100vw","max-width":"100vw"},square:""},{default:t(()=>[e(ie,{class:se({"bg-secondary":!0,"text-white":!0,"shadow-2":!0})},{default:t(()=>[W(e(X,{flat:"",dense:"",icon:"arrow_back"},null,512),[[Z]]),e(re,null,{default:t(()=>[o(n(x.data.data.discipline[0].description)+" - "+n(x.eleve.nom)+" "+n(x.eleve.prenom),1)]),_:1})]),_:1}),e(le,null,{default:t(()=>[e(r(we),{class:"chart",option:C.value},null,8,["option"])]),_:1}),e(le,{class:"bg-grey-2"},{default:t(()=>[T("div",He,[T("div",Ke,[e(I,{class:"bg-white shadow-1"},{default:t(()=>[e(g,{avatar:"",class:"text-positive"},{default:t(()=>[e(U,{"font-size":"40px"},{default:t(()=>[e(P,{name:"keyboard_double_arrow_up"})]),_:1})]),_:1}),e(g,null,{default:t(()=>[e(c,{class:"text-h4"},{default:t(()=>[o(n(y().note.toFixed(2)),1)]),_:1}),e(c,null,{default:t(()=>[o(n(D(y())),1)]),_:1}),e(c,{caption:""},{default:t(()=>[o(n(y().data.periodes.periode_fr+" - C"+y().data.numero),1)]),_:1})]),_:1})]),_:1})]),T("div",Ge,[e(I,{class:"bg-white shadow-1"},{default:t(()=>[e(g,{avatar:"",class:"text-negative"},{default:t(()=>[e(U,{"font-size":"40px"},{default:t(()=>[e(P,{name:"keyboard_double_arrow_down"})]),_:1})]),_:1}),e(g,null,{default:t(()=>[e(c,{class:"text-h4"},{default:t(()=>[o(n(d().note.toFixed(2)),1)]),_:1}),e(c,null,{default:t(()=>[o(n(D(d())),1)]),_:1}),e(c,{caption:""},{default:t(()=>[o(n(d().data.periodes.periode_fr+" - C"+d().data.numero),1)]),_:1})]),_:1})]),_:1})])])]),_:1}),b.value?(s(),p(ae,{key:0,separator:"",bordered:""},{default:t(()=>[(s(!0),Q(L,null,Y(b.value,(f,w)=>(s(),Q(L,null,[e(I,{clickable:""},{default:t(()=>[e(g,null,{default:t(()=>[e(c,{style:{"font-weight":"600","font-size":"var(--taille-m)"}},{default:t(()=>[o(n(f.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),(s(!0),Q(L,null,Y(f.data,($,O)=>(s(),p(I,{dense:""},{default:t(()=>[e(g,null,{default:t(()=>[e(c,null,{default:t(()=>[o(n($.matieres.matiere_fr),1)]),_:2},1024)]),_:2},1024),e(g,{avatar:""},{default:t(()=>[e(c,null,{default:t(()=>[o(n(a($.notes_personnes)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))],64))),256))]),_:1})):A("",!0)]),_:1}),e(H)],64))}},Xe=ne(We,[["__scopeId","data-v-0d6d338f"]]),Ze={__name:"Notes",props:["eleve","classe","annee"],setup(x){ge([he,ye,xe,Ce,Re,$e,Ve]),be(ke,"light");let m=j(!1),S=j(null);const V=x;ee();const v=te();k(()=>v.getters["user/current"]);const i=k(()=>v.getters["stats/notes"]),b=k(()=>ue(l=>l.matieres.discipline[0].iddiscipline,i.value.eleve)),B=k(()=>ue(l=>l.matieres.discipline[0].iddiscipline,i.value.classe)),C=k(()=>Object.keys(b.value).map(f=>({id:parseInt(f),discipline:b.value[f][0].matieres.discipline,data:b.value[f]}))),q=k(()=>Object.keys(B.value).map(f=>({id:parseInt(f),discipline:B.value[f][0].matieres.discipline,data:B.value[f]}))),N=k(()=>({tooltip:{trigger:"item"},grid:{bottom:120,left:0,right:0},legend:{center:"top",data:[V.eleve.nom+" "+V.eleve.prenom,V.classe.classe_fr]},xAxis:{type:"category",data:z.value,axisLabel:{show:!0,interval:0,rotate:45}},yAxis:{type:"value",show:!1},series:[{data:M.value,type:"bar",name:V.eleve.nom+" "+V.eleve.prenom,color:"#32D305"},{data:a.value,type:"bar",name:V.classe.classe_fr,color:"#07331B"}]})),z=k(()=>d().map(l=>l.discipline[0].description)),M=k(()=>d().map(l=>l.data.toFixed(2))),a=k(()=>{let l=d(!0);return d().map(f=>{let w=l.find($=>$.id===f.id);return w?w.data.toFixed(2):null})});function y(l){S.value={data:l,eleve:C.value,classe:q.value},m.value=!0}function d(l){let f=null;return l?f=q.value:f=C.value,f.map(w=>{let $=de("notes_personnes",w.data).map(O=>O.length?ce(de("note",O))/O.length:0);return $.length?$=ce($)/$.length:$=0,{id:w.id,discipline:w.discipline,data:$}})}function D(){v.dispatch("stats/getNotes",u())}function u(){let l={annee:V.annee.idannee,classe:V.classe.idclasse};return V.eleve&&(l.eleve=V.eleve.idpers),l}return v.commit("stats/setNotes",null),D(),(l,f)=>(s(),Q(L,null,[e(G,{style:{"min-width":"100vw","max-width":"100vw"}},{default:t(()=>[e(ie,{class:se({"bg-secondary":!0,"text-white":!0,"shadow-2":!0})},{default:t(()=>[W(e(X,{flat:"",dense:"",icon:"arrow_back"},null,512),[[Z]]),e(re,null,{default:t(()=>[o(n(x.eleve.nom)+" "+n(x.eleve.prenom),1)]),_:1})]),_:1}),i.value?(s(),Q(L,{key:0},[e(le,null,{default:t(()=>[e(r(we),{class:"chart",option:N.value},null,8,["option"])]),_:1}),b.value?(s(),p(ae,{key:0,separator:"",bordered:""},{default:t(()=>[(s(!0),Q(L,null,Y(d(),(w,$)=>(s(),p(I,{onClick:O=>y(w),clickable:""},{default:t(()=>[e(g,null,{default:t(()=>[e(c,{style:{"font-weight":"600","font-size":"var(--taille-m)"}},{default:t(()=>[o(n(w.discipline[0].description),1)]),_:2},1024)]),_:2},1024),e(g,{avatar:""},{default:t(()=>[e(c,null,{default:t(()=>[o(n(w.data.toFixed(2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),256))]),_:1})):A("",!0)],64)):A("",!0)]),_:1}),e(H,{modelValue:r(m),"onUpdate:modelValue":f[0]||(f[0]=w=>F(m)?m.value=w:m=w),position:"bottom",maximized:""},{default:t(()=>[r(S)?(s(),p(Xe,{key:0,data:r(S),eleve:x.eleve,classe:x.classe},null,8,["data","eleve","classe"])):A("",!0)]),_:1},8,["modelValue"])],64))}},et=ne(Ze,[["__scopeId","data-v-01f7d545"]]),tt={key:2,class:"relative-position",style:{"min-height":"20vh"}},at={__name:"Absences",props:["bilan","classe","annee"],setup(x){ve(a=>({"0b975ba7":r(V)})),ge([he,ye,xe,Ce,qe,$e,Ve,Me]),be(ke,"light");const m=x;ee();const S=te();k(()=>S.getters["user/current"]);let V="350px",v=M();const i=j(!1);Se(()=>i.value=!0);const b=[],B=["800","1000","1200","1400","1600","1800"],C=[1,2,3,4,5,6],q=["","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi","Dimanche"];v.forEach((a,y)=>{let d=[];a.data.forEach((D,u)=>{d.push([D.jour,D.debut,D.duree_absence])}),b.push({name:a.label,type:"scatter",data:d,itemStyle:{color:a.discipline.color},symbolSize:function(D){return D[2]/3}})});const N=j({legend:{show:!0},grid:{containLabel:!0,left:0,right:0,bottom:0},tooltip:{trigger:"item",formatter:a=>a.marker+"<b>"+a.seriesName+"</b><br>"+(a.data[0]<7?q[a.data[0]]:"")+" à "+String(a.data[1]).replace(/(.)(?=(\d{2})+$)/g,"$1h")+"<br>"+a.data[2]+"min"},xAxis:{type:"category",data:C.sort(),min:0,max:5,axisLabel:{show:!0,rotate:45,formatter:(a,y)=>a<7?q[a]:""}},yAxis:{type:"value",data:B,min:600,axisLabel:{show:!0,interval:200,formatter:function(a,y){return String(a).replace(/(.)(?=(\d{2})+$)/g,"$1h")}}},series:b});function z(){return m.bilan&&m.bilan.eleve&&m.bilan.eleve.absences_eleve?m.bilan.eleve.absences_eleve.filter(a=>a.is_absence===1):[]}function M(){let a=ue(d=>d.idmatiere,z());return Object.keys(a).map(d=>({id:parseInt(d),label:a[d][0].matieres.matiere_fr,discipline:a[d][0].matieres.discipline[0],data:a[d]}))}return(a,y)=>(s(),p(G,{style:{"min-width":"100vw","max-width":"100vw"}},{default:t(()=>[e(ie,{class:se({"bg-secondary":!0,"text-white":!0,"shadow-2":!0})},{default:t(()=>[W(e(X,{flat:"",dense:"",icon:"arrow_back"},null,512),[[Z]]),e(re,null,{default:t(()=>[o(n(x.bilan.eleve.nom)+" "+n(x.bilan.eleve.prenom),1)]),_:1})]),_:1}),N.value&&r(v)&&r(v).length&&i.value?(s(),p(le,{key:0},{default:t(()=>[e(r(we),{class:"chart",option:N.value},null,8,["option"])]),_:1})):A("",!0),r(v)&&r(v).length?(s(),p(ae,{key:1,separator:"",bordered:""},{default:t(()=>[(s(!0),Q(L,null,Y(r(v),(d,D)=>(s(),Q(L,null,[e(I,{clickable:"",style:fe({"border-bottom":d.discipline.color+" 5px solid"})},{default:t(()=>[e(g,null,{default:t(()=>[e(c,{style:{"font-weight":"600","font-size":"var(--taille-m)"}},{default:t(()=>[o(n(d.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["style"]),(s(!0),Q(L,null,Y(d.data,(u,l)=>(s(),p(I,null,{default:t(()=>[e(g,null,{default:t(()=>[e(c,null,{default:t(()=>[o(n(r(De)(r(me)(String(u.date_absence).substring(0,8)),"E d MMM Y"))+" ",1),e(c,null,{default:t(()=>[u.justifer?(s(),p(_e,{key:0,color:"positive"},{default:t(()=>y[0]||(y[0]=[o("Justifé")])),_:1})):(s(),p(_e,{key:1,color:"negative"},{default:t(()=>y[1]||(y[1]=[o("Non justifé")])),_:1}))]),_:2},1024)]),_:2},1024)]),_:2},1024),e(g,{side:""},{default:t(()=>[e(c,null,{default:t(()=>[o(n(String(u.debut).replace(/(.)(?=(\d{2})+$)/g,"$1h")),1)]),_:2},1024),e(c,null,{default:t(()=>[o(n(u.duree_absence)+"min ",1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))],64))),256))]),_:1})):(s(),Q("div",tt,[e(K,{class:"q-mt-md",src:"/under.svg",style:{"max-width":"550px"}})]))]),_:1}))}},lt=ne(at,[["__scopeId","data-v-b9a99950"]]),nt={key:2,class:"relative-position",style:{"min-height":"20vh"}},st={__name:"Retards",props:["bilan","classe","annee"],setup(x){ve(a=>({"2f896fd7":r(V)})),ge([he,ye,xe,Ce,qe,$e,Ve,Me]),be(ke,"light");const m=x;ee();const S=te();k(()=>S.getters["user/current"]);let V="350px",v=M();const i=j(!1);Se(()=>i.value=!0);const b=[],B=["800","1000","1200","1400","1600","1800"],C=[1,2,3,4,5,6],q=["","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi","Dimanche"];v.forEach((a,y)=>{let d=[];a.data.forEach((D,u)=>{d.push([D.jour,D.debut,D.duree_absence])}),b.push({name:a.label,type:"scatter",data:d,itemStyle:{color:a.discipline.color},symbolSize:function(D){return D[2]/2}})});const N=j({legend:{show:!0},grid:{containLabel:!0,left:0,right:0,bottom:0},tooltip:{trigger:"item",formatter:a=>a.marker+"<b>"+a.seriesName+"</b><br>"+(a.data[0]<7?q[a.data[0]]:"")+" à "+String(a.data[1]).replace(/(.)(?=(\d{2})+$)/g,"$1h")+"<br>"+a.data[2]+"min"},xAxis:{type:"category",data:C.sort(),min:0,max:5,axisLabel:{show:!0,rotate:45,formatter:(a,y)=>a<7?q[a]:""}},yAxis:{type:"value",data:B,min:600,axisLabel:{show:!0,interval:200,formatter:function(a,y){return String(a).replace(/(.)(?=(\d{2})+$)/g,"$1h")}}},series:b});function z(){return m.bilan&&m.bilan.eleve&&m.bilan.eleve.absences_eleve?m.bilan.eleve.absences_eleve.filter(a=>a.is_absence===0):[]}function M(){let a=ue(d=>d.idmatiere,z());return Object.keys(a).map(d=>({id:parseInt(d),label:a[d][0].matieres.matiere_fr,discipline:a[d][0].matieres.discipline[0],data:a[d]}))}return(a,y)=>(s(),p(G,{style:{"min-width":"100vw","max-width":"100vw"}},{default:t(()=>[e(ie,{class:se({"bg-secondary":!0,"text-white":!0,"shadow-2":!0})},{default:t(()=>[W(e(X,{flat:"",dense:"",icon:"arrow_back"},null,512),[[Z]]),e(re,null,{default:t(()=>[o(n(x.bilan.eleve.nom)+" "+n(x.bilan.eleve.prenom),1)]),_:1})]),_:1}),N.value&&r(v)&&r(v).length&&i.value?(s(),p(le,{key:0},{default:t(()=>[e(r(we),{class:"chart",option:N.value},null,8,["option"])]),_:1})):A("",!0),r(v)&&r(v).length?(s(),p(ae,{key:1,separator:"",bordered:""},{default:t(()=>[(s(!0),Q(L,null,Y(r(v),(d,D)=>(s(),Q(L,null,[e(I,{clickable:"",style:fe({"border-bottom":d.discipline.color+" 5px solid"})},{default:t(()=>[e(g,null,{default:t(()=>[e(c,{style:{"font-weight":"600","font-size":"var(--taille-m)"}},{default:t(()=>[o(n(d.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["style"]),(s(!0),Q(L,null,Y(d.data,(u,l)=>(s(),p(I,null,{default:t(()=>[e(g,null,{default:t(()=>[e(c,null,{default:t(()=>[o(n(r(De)(r(me)(String(u.date_absence).substring(0,8)),"E d MMM Y"))+" ",1),e(c,null,{default:t(()=>[u.justifer?(s(),p(_e,{key:0,color:"positive"},{default:t(()=>y[0]||(y[0]=[o("Justifé")])),_:1})):(s(),p(_e,{key:1,color:"negative"},{default:t(()=>y[1]||(y[1]=[o("Non justifé")])),_:1}))]),_:2},1024)]),_:2},1024)]),_:2},1024),e(g,{side:""},{default:t(()=>[e(c,null,{default:t(()=>[o(n(String(u.debut).replace(/(.)(?=(\d{2})+$)/g,"$1h")),1)]),_:2},1024),e(c,null,{default:t(()=>[o(n(u.duree_absence)+"min ",1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))],64))),256))]),_:1})):(s(),Q("div",nt,[e(K,{class:"q-mt-md",src:"/under.svg",style:{"max-width":"550px"}})]))]),_:1}))}},rt=ne(st,[["__scopeId","data-v-535db0fe"]]),it={key:1,class:"relative-position",style:{"min-height":"20vh"}},ot={__name:"Maladies",props:["bilan","classe","annee"],setup(x){ve(i=>({"728093de":r(V)}));const m=x;ee();const S=te();k(()=>S.getters["user/current"]);let V="350px",v=m.bilan.eleve.maladies;return(i,b)=>(s(),p(G,{style:{"min-width":"100vw","max-width":"100vw"}},{default:t(()=>[e(ie,{class:se({"bg-secondary":!0,"text-white":!0,"shadow-2":!0})},{default:t(()=>[W(e(X,{flat:"",dense:"",icon:"arrow_back"},null,512),[[Z]]),e(re,null,{default:t(()=>[o(n(x.bilan.eleve.nom)+" "+n(x.bilan.eleve.prenom),1)]),_:1})]),_:1}),r(v)&&r(v).length?(s(),p(ae,{key:0,separator:"",bordered:""},{default:t(()=>[(s(!0),Q(L,null,Y(r(v),(B,C)=>(s(),p(I,{clickable:""},{default:t(()=>[e(g,null,{default:t(()=>[e(c,{style:{"font-weight":"600","font-size":"var(--taille-m)"}},{default:t(()=>[o(n(B.maladies.description),1)]),_:2},1024),e(c,null,{default:t(()=>[e(P,{class:"float-left",name:"sym_o_medication"}),b[0]||(b[0]=o()),T("span",null,n(B.traitement.description),1)]),_:2},1024),B.idreport>1?(s(),p(c,{key:0},{default:t(()=>[o(n(B.report.description),1)]),_:2},1024)):A("",!0)]),_:2},1024),B.idtype>1?(s(),p(g,{key:0,side:"",top:""},{default:t(()=>[e(c,null,{default:t(()=>[o(n(B.type.description),1)]),_:2},1024)]),_:2},1024)):A("",!0)]),_:2},1024))),256))]),_:1})):(s(),Q("div",it,[e(K,{class:"q-mt-md",src:"/med.svg",style:{"max-width":"550px"}})]))]),_:1}))}},ut=ne(ot,[["__scopeId","data-v-4c7544c7"]]),dt={key:1,class:"relative-position",style:{"min-height":"20vh"}},ct={class:"flex flex-center",style:{"max-width":"85%"}},ft={__name:"Infractions",props:["bilan","classe","annee"],setup(x){ve(q=>({"0dc077cc":r(V)}));const m=x;ee();const S=te();k(()=>S.getters["user/current"]);let V="350px",v=m.bilan.eleve.infractions,i=j(!1),b=null;function B(q){b=q,i.value=!0}function C(q){if(q.grave===1)return"var(--q-positive)";if(q.grave===2)return"var(--q-warning)";if(q.grave===3)return"var(--q-negative)"}return(q,N)=>(s(),p(G,{style:{"min-width":"100vw","max-width":"100vw"}},{default:t(()=>[e(ie,{class:se({"bg-secondary":!0,"text-white":!0,"shadow-2":!0})},{default:t(()=>[W(e(X,{flat:"",dense:"",icon:"arrow_back"},null,512),[[Z]]),e(re,null,{default:t(()=>[o(n(x.bilan.eleve.nom)+" "+n(x.bilan.eleve.prenom),1)]),_:1})]),_:1}),r(v)&&r(v).length?(s(),p(ae,{key:0,separator:""},{default:t(()=>[(s(!0),Q(L,null,Y(r(v),(z,M)=>(s(),p(I,{key:M,clickable:"",style:fe("border-left: 5px solid "+C(z)),onClick:a=>B(z)},{default:t(()=>[e(g,null,{default:t(()=>[e(c,{style:{"font-weight":"600"}},{default:t(()=>[o(n(z.infraction.description),1)]),_:2},1024),e(c,{lines:1},{default:t(()=>[o(n(z.observation),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["style","onClick"]))),128))]),_:1})):(s(),Q("div",dt,[e(K,{class:"q-mt-md",src:"/camp.svg",style:{"max-width":"550px"}})])),e(H,{modelValue:r(i),"onUpdate:modelValue":N[0]||(N[0]=z=>F(i)?i.value=z:i=z),position:"left",maximized:""},{default:t(()=>[e(G,null,{default:t(()=>[e(le,{class:"row text-white",style:fe("font-weight:600;background-color: "+C(r(b)))},{default:t(()=>[T("div",ct,n(r(b).infraction.description),1),e(Je),W(e(X,{icon:"close",flat:"",round:"",dense:""},null,512),[[Z]])]),_:1},8,["style"]),e(le,null,{default:t(()=>[o(n(r(b).observation),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},mt=ne(ft,[["__scopeId","data-v-62b2410d"]]),vt={key:1,class:"relative-position",style:{"min-height":"20vh"}},pt={__name:"Rencontres",props:["bilan","classe","annee"],setup(x){ve(b=>({"1bce7908":r(V)}));const m=x;ee();const S=te();k(()=>S.getters["user/current"]);let V="350px",v=m.bilan.eleve.meetings_eleve;function i(b){if(b.result===1)return"var(--q-positive)";if(b.result===2)return"var(--q-warning)";if(b.result===3)return"var(--q-negative)"}return(b,B)=>(s(),p(G,{style:{"min-width":"100vw","max-width":"100vw"}},{default:t(()=>[e(ie,{class:se({"bg-secondary":!0,"text-white":!0,"shadow-2":!0})},{default:t(()=>[W(e(X,{flat:"",dense:"",icon:"arrow_back"},null,512),[[Z]]),e(re,null,{default:t(()=>[o(n(x.bilan.eleve.nom)+" "+n(x.bilan.eleve.prenom),1)]),_:1})]),_:1}),r(v)&&r(v).length?(s(),p(ae,{key:0,separator:""},{default:t(()=>[(s(!0),Q(L,null,Y(r(v),(C,q)=>(s(),p(I,{clickable:"",style:fe("border-left: 5px solid "+i(C))},{default:t(()=>[e(g,null,{default:t(()=>[e(c,null,{default:t(()=>[C.parent?(s(),p(ze,{key:0,class:"q-ma-none",dense:"",square:"",color:"secondary","text-color":"white"},{default:t(()=>[e(U,null,{default:t(()=>[e(K,{src:r(Qe)(C.parent),ratio:"1"},null,8,["src"])]),_:2},1024),o("  "+n(C.parent.nom)+" "+n(C.parent.prenom),1)]),_:2},1024)):A("",!0),e(P,{name:"width"}),C.personne?(s(),p(ze,{key:1,class:"q-ma-none",dense:"",square:"",color:"primary","text-color":"white"},{default:t(()=>[e(U,null,{default:t(()=>[e(K,{src:r(Qe)(C.personne),ratio:"1"},null,8,["src"])]),_:2},1024),o("  "+n(C.personne.nom)+" "+n(C.personne.prenom),1)]),_:2},1024)):A("",!0)]),_:2},1024),e(c,{style:{"font-weight":"600","font-size":"var(--taille-m)"}},{default:t(()=>[o(n(C.objet),1)]),_:2},1024),e(c,null,{default:t(()=>[o(n(C.observation),1)]),_:2},1024),e(c,{caption:""},{default:t(()=>[o(n(r(De)(r(me)(C.date_meeting),"E d MMM Y H:mm")),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["style"]))),256))]),_:1})):(s(),Q("div",vt,[e(K,{class:"q-mt-md",src:"/meet.svg",style:{"max-width":"550px"}})]))]),_:1}))}},_t=ne(pt,[["__scopeId","data-v-8b1ae82d"]]),bt={class:"q-pa-lg flex flex-center tour"},gt={key:0},ht={class:"bg-grey-2 q-pa-md"},yt={class:"row q-col-gutter-sm"},xt={class:"col-md-3 col-sm-12 col-6"},wt={key:1,class:"relative-position full-height",style:{"min-height":"50vh"}},Wt={__name:"BilanEducatif",setup(x){ee();const m=te(),S=k(()=>m.getters["user/current"]),v=k(()=>m.getters["user/config"]).value.roles,i=k(()=>m.getters["stats/bilan"]),b=k(()=>m.getters["stats/eleves"]);let B=j(null);const C={useKeyboardNavigation:!1,highlight:!0,labels:{buttonSkip:"Fermer",buttonPrevious:"Precedant",buttonNext:"Suivant",buttonStop:"Fermer"}};let q=[{target:".tour",content:"Veuillez sélectionner un élève"}];Se(()=>{B.value.start()});let N=j(b.value.map(E=>({label:E.nom+" "+E.prenom,value:E.idpers}))),z=j(!1),M=j(!1),a=j(!1),y=j(!1),d=j(!1),D=j(!1);const u=k(()=>{if(S.value&&S.value.hasOwnProperty("annee"))return S.value.annee}),l=k(()=>{if(S.value&&S.value.hasOwnProperty("classe"))return S.value.classe});let f=j(null);Ne(l,(E,h)=>{$()}),m.commit("setTitle","Bilan éducatif");function w(){B.value.finish()}function $(){Ie(),m.dispatch("stats/getEleves",Be())}function O(){f.value&&m.dispatch("stats/getBilan",Be()).then(()=>{i.value&&m.commit("setTitle",i.value.titre)})}function J(){return i.value&&i.value.eleve&&i.value.eleve.absences_eleve?i.value.eleve.absences_eleve.filter(E=>E.is_absence===1):[]}function Ae(){return i.value&&i.value.eleve&&i.value.eleve.absences_eleve?i.value.eleve.absences_eleve.filter(E=>E.is_absence===0):[]}function oe(E,h,R){if(i.value){let _=null;if(R?_=i.value.section.find(pe=>pe.key===E&&pe.type===R):_=i.value.section.find(pe=>pe.key===E),_)return _.label}return h}function Ie(){m.dispatch("stats/reset"),f.value=null}function Be(){let E={annee:u.value.idannee,classe:l.value.idclasse};return f.value&&(E.eleve=f.value.value),E}function Ee(E,h){if(E===""){h(()=>{N.value=b.value.map(R=>({label:R.nom+" "+R.prenom,value:R.idpers}))});return}h(()=>{const R=E.toLowerCase();N.value=b.value.map(_=>({label:_.nom+" "+_.prenom,value:_.idpers})).filter(_=>_.label.toLowerCase().indexOf(R)>-1)})}return $(),(E,h)=>{const R=je("v-tour");return s(),Q(L,null,[e(Oe,{class:"page-content"},{default:t(()=>[T("div",bt,[e(Le,{"use-input":"","input-debounce":"0",onFilter:Ee,onClick:w,options:r(N),label:"Eleve",modelValue:r(f),"onUpdate:modelValue":[h[0]||(h[0]=_=>F(f)?f.value=_:f=_),O],class:"full-width text-white"},null,8,["options","modelValue"])]),i.value&&i.value.eleve?(s(),Q("div",gt,[e(G,{flat:"",bordered:""},{default:t(()=>[e(I,null,{default:t(()=>[e(g,{avatar:""},{default:t(()=>[e(U,{size:"60px"},{default:t(()=>[e(K,{src:r(Qe)(i.value.eleve),ratio:"1"},null,8,["src"])]),_:1})]),_:1}),e(g,null,{default:t(()=>[e(c,null,{default:t(()=>[o(n(i.value.eleve.nom)+" "+n(i.value.eleve.prenom),1)]),_:1}),e(c,{caption:"",style:{"font-weight":"600"}},{default:t(()=>[o(n(l.value.classe_fr),1)]),_:1}),e(c,{caption:""},{default:t(()=>[o(n(i.value.eleve.code),1)]),_:1}),e(c,{caption:""},{default:t(()=>[e(P,{name:"icon_anniversaire"}),o(" "+n(r(De)(r(me)(i.value.eleve.datenaissance),"d/MM/Y"))+" ("+n(r(Te)(new Date,r(me)(i.value.eleve.datenaissance)))+") ",1)]),_:1})]),_:1})]),_:1}),i.value.eleve.ara_adresse&&r(v).admin?(s(),Q(L,{key:0},[e(Fe),e(I,null,{default:t(()=>[e(g,{avatar:""},{default:t(()=>[e(U,null,{default:t(()=>[e(P,{name:"family_restroom"})]),_:1})]),_:1}),e(g,null,{default:t(()=>[e(c,{style:{"font-size":"var(--taille-m)","font-weight":"600"}},{default:t(()=>h[13]||(h[13]=[o("Situation familiale ")])),_:1}),e(c,null,{default:t(()=>[o(n(i.value.eleve.ara_adresse),1)]),_:1})]),_:1})]),_:1})],64)):A("",!0)]),_:1}),T("div",ht,[T("div",yt,[T("div",xt,[e(I,{class:"bg-white shadow-1",onClick:h[1]||(h[1]=_=>F(d)?d.value=!0:d=!0),clickable:""},{default:t(()=>[e(g,{avatar:"",class:"text-red"},{default:t(()=>[e(U,{"font-size":"30px"},{default:t(()=>[e(P,{name:"icon_absences"})]),_:1})]),_:1}),e(g,null,{default:t(()=>[e(c,{class:"text-h4"},{default:t(()=>[o(n(J().length),1)]),_:1}),e(c,null,{default:t(()=>[o(n(oe("eleve.absencesEleve","Absences","absence")),1)]),_:1})]),_:1})]),_:1})]),T("div",{class:"col-md-3 col-sm-12 col-6",onClick:h[2]||(h[2]=_=>F(D)?D.value=!0:D=!0),clickable:""},[e(I,{class:"bg-white shadow-1"},{default:t(()=>[e(g,{avatar:"",class:"text-blue"},{default:t(()=>[e(U,{"font-size":"30px"},{default:t(()=>[e(P,{name:"icon_retard"})]),_:1})]),_:1}),e(g,null,{default:t(()=>[e(c,{class:"text-h4"},{default:t(()=>[o(n(Ae().length),1)]),_:1}),e(c,null,{default:t(()=>[o(n(oe("eleve.absencesEleve","Retards","retard")),1)]),_:1})]),_:1})]),_:1})])])]),e(ae,{separator:"",dense:"",bordered:""},{default:t(()=>[e(I,{onClick:h[3]||(h[3]=_=>F(z)?z.value=!0:z=!0),clickable:""},{default:t(()=>[e(g,null,{default:t(()=>[e(c,null,{default:t(()=>[o(n(oe("eleve.notes","Notes")),1)]),_:1})]),_:1}),e(g,{avatar:""},{default:t(()=>[e(U,null,{default:t(()=>[e(P,{name:"arrow_forward_ios"})]),_:1})]),_:1})]),_:1}),r(v).admin?(s(),p(I,{key:0,onClick:h[4]||(h[4]=_=>F(M)?M.value=!0:M=!0),clickable:""},{default:t(()=>[e(g,null,{default:t(()=>[e(c,null,{default:t(()=>[o(n(oe("eleve.infractions","infractions")),1)]),_:1})]),_:1}),e(g,{avatar:""},{default:t(()=>[e(U,null,{default:t(()=>[e(P,{name:"arrow_forward_ios"})]),_:1})]),_:1})]),_:1})):A("",!0),r(v).admin?(s(),p(I,{key:1,onClick:h[5]||(h[5]=_=>F(a)?a.value=!0:a=!0),clickable:""},{default:t(()=>[e(g,null,{default:t(()=>[e(c,null,{default:t(()=>[o(n(oe("eleve.maladies","maladies")),1)]),_:1})]),_:1}),e(g,{avatar:""},{default:t(()=>[e(U,null,{default:t(()=>[e(P,{name:"arrow_forward_ios"})]),_:1})]),_:1})]),_:1})):A("",!0),r(v).admin?(s(),p(I,{key:2,onClick:h[6]||(h[6]=_=>F(y)?y.value=!0:y=!0),clickable:""},{default:t(()=>[e(g,null,{default:t(()=>[e(c,null,{default:t(()=>[o(n(oe("eleve.meetingsEleve","Rencontres")),1)]),_:1})]),_:1}),e(g,{avatar:""},{default:t(()=>[e(U,null,{default:t(()=>[e(P,{name:"arrow_forward_ios"})]),_:1})]),_:1})]),_:1})):A("",!0)]),_:1})])):(s(),Q("div",wt,[e(K,{class:"absolute-center",src:"/birkar.svg",style:{"max-width":"550px"}})]))]),_:1}),i.value?(s(),p(H,{key:0,modelValue:r(z),"onUpdate:modelValue":h[7]||(h[7]=_=>F(z)?z.value=_:z=_),maximized:"",position:"right"},{default:t(()=>[e(et,{eleve:i.value.eleve,annee:u.value,classe:l.value},null,8,["eleve","annee","classe"])]),_:1},8,["modelValue"])):A("",!0),i.value?(s(),p(H,{key:1,modelValue:r(d),"onUpdate:modelValue":h[8]||(h[8]=_=>F(d)?d.value=_:d=_),maximized:"",position:"right"},{default:t(()=>[e(lt,{bilan:i.value,annee:u.value,classe:l.value},null,8,["bilan","annee","classe"])]),_:1},8,["modelValue"])):A("",!0),i.value?(s(),p(H,{key:2,modelValue:r(D),"onUpdate:modelValue":h[9]||(h[9]=_=>F(D)?D.value=_:D=_),maximized:"",position:"right"},{default:t(()=>[e(rt,{bilan:i.value,annee:u.value,classe:l.value},null,8,["bilan","annee","classe"])]),_:1},8,["modelValue"])):A("",!0),i.value?(s(),p(H,{key:3,modelValue:r(a),"onUpdate:modelValue":h[10]||(h[10]=_=>F(a)?a.value=_:a=_),maximized:"",position:"right"},{default:t(()=>[e(ut,{bilan:i.value,annee:u.value,classe:l.value},null,8,["bilan","annee","classe"])]),_:1},8,["modelValue"])):A("",!0),i.value?(s(),p(H,{key:4,modelValue:r(M),"onUpdate:modelValue":h[11]||(h[11]=_=>F(M)?M.value=_:M=_),maximized:"",position:"right"},{default:t(()=>[e(mt,{bilan:i.value,annee:u.value,classe:l.value},null,8,["bilan","annee","classe"])]),_:1},8,["modelValue"])):A("",!0),i.value?(s(),p(H,{key:5,modelValue:r(y),"onUpdate:modelValue":h[12]||(h[12]=_=>F(y)?y.value=_:y=_),maximized:"",position:"right"},{default:t(()=>[e(_t,{bilan:i.value,annee:u.value,classe:l.value},null,8,["bilan","annee","classe"])]),_:1},8,["modelValue"])):A("",!0),e(R,{ref_key:"tour",ref:B,steps:r(q),options:C},null,8,["steps"])],64)}}};export{Wt as default};
