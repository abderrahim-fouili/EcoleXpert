import{Q as c}from"./QImg-BMvxJu3S.js";import{_ as b,as as h,at as w,Q as V,S as y,a6 as o,a5 as l,aE as v,aF as m,a7 as Q,a2 as i,aG as f,a3 as d,ad as p,ax as q,aC as x,aB as C,q as U}from"./index-Bl2lQPd7.js";import{Q as g}from"./QForm-Dk45GsL9.js";const k={name:"Profile",data(){return{labels:{login:"Nom d'utilisateur",oldpasse:"Mot de passe actuel",confirm:"Confirmer le mot de passe",new:"Nouveau mot de passe",email:"Email",nom:"Nom",prenom:"Prenom"},form:{idpers:null,login:null,oldpasse:null,confirm:null,new:null,email:null,nom:null,prenom:null,type:"profil"}}},computed:{...w({user:"user/user",config:"user/config"})},methods:{...h({refreshUser:"user/getUserInfo",update:"user/enregistrer",getConfig:"user/getConfig"}),permission(a){return U()},avatar(){return C(this.user)},save(a,e){this.form.type=e,this.$refs[a].validate().then(u=>{if(!u)return this.$q.notify({color:"negative",message:this.$t("stats.fields"),position:"bottom-right",icon:"error_outline",actions:[{label:this.$q.lang.label.close,color:"yellow"}]}),!1;this.update(this.form).then(r=>{r.success&&(this.$q.notify({color:"positive",message:this.$t("stats.success"),position:"bottom-right",icon:"done_all",actions:[{label:this.$q.lang.label.ok,color:"yellow"}]}),this.refreshUser())}).catch(({response:r})=>{r.status===422&&this.$q.notify({color:"negative",message:this.findErrorLabel(r.data.errors),position:"bottom-right",icon:"warning",actions:[{label:this.$q.lang.label.ok,color:"yellow"}]})})})},findErrorLabel(a){for(const e in this.labels)if(Object.hasOwnProperty.call(a,e))return String(a[e][0]).replace(e,this.labels[e])}},mounted(){this.form={...this.user},this.form.passe=null,this.setTitle("Profil")}};function E(a,e,u,r,t,n){return y(),V(x,{class:"page-content row justify-center bg-transparent"},{default:o(()=>[l(v,{class:"col-xs-12 col-md-8 bg-transparent",flat:""},{default:o(()=>[l(m,{class:"bg-transparent flex flex-center",style:{padding:"5rem"}},{default:o(()=>[l(Q,{size:"10rem",class:"shadow-2"},{default:o(()=>[l(c,{src:n.avatar()},null,8,["src"])]),_:1})]),_:1}),l(g,{autocomplete:"off",ref:"profileForm",class:"shadow-up-1"},{default:o(()=>[l(m,{class:"bg-white q-gutter-lg"},{default:o(()=>[l(i,{filled:"",modelValue:t.form.email,"onUpdate:modelValue":e[0]||(e[0]=s=>t.form.email=s),label:"Email"},null,8,["modelValue"]),l(i,{filled:"",modelValue:t.form.login,"onUpdate:modelValue":e[1]||(e[1]=s=>t.form.login=s),label:"Nom d'utilisateur"},null,8,["modelValue"])]),_:1}),l(f,{align:"right",class:"q-mb-md bg-white"},{default:o(()=>[l(d,{onClick:e[2]||(e[2]=s=>n.save("profileForm","profil"))},{default:o(()=>e[7]||(e[7]=[p("Enregistrer")])),_:1})]),_:1})]),_:1},512),l(q),l(g,{autocomplete:"off",ref:"passwordForm"},{default:o(()=>[l(m,{class:"q-gutter-lg bg-white"},{default:o(()=>[l(i,{filled:"",autocomplete:"off",modelValue:t.form.oldpasse,"onUpdate:modelValue":e[3]||(e[3]=s=>t.form.oldpasse=s),label:"Mot de passe actuel",type:"password"},null,8,["modelValue"]),l(i,{filled:"",autocomplete:"off",modelValue:t.form.new,"onUpdate:modelValue":e[4]||(e[4]=s=>t.form.new=s),label:"Nouveau mot de passe",type:"password",hint:"Votre mot de passe doit contenir au minimum 6 caractÃ¨res, au moins une lettre minuscule et  une lettre majuscule et un chiffre "},null,8,["modelValue"]),l(i,{class:"q-mt-xl",filled:"",autocomplete:"off",modelValue:t.form.confirm,"onUpdate:modelValue":e[5]||(e[5]=s=>t.form.confirm=s),label:"Confirmer le mot de passe",type:"password"},null,8,["modelValue"])]),_:1}),l(f,{align:"right",class:"q-mb-md bg-white"},{default:o(()=>[l(d,{onClick:e[6]||(e[6]=s=>n.save("passwordForm","passe"))},{default:o(()=>e[8]||(e[8]=[p("Enregistrer")])),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})}const _=b(k,[["render",E]]);export{_ as default};
