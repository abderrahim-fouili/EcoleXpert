import{Q as _}from"./QImg-BMvxJu3S.js";import{_ as b,aY as x,b8 as k,b9 as v,b2 as Q,ba as w,as as y,at as L,Q as d,S as o,a6 as a,a5 as s,a4 as u,a9 as f,aa as p,av as I,a7 as C,R as M,a8 as A,ad as i,ab as l,af as g,ah as B,ay as N,aw as q,aE as D,be as U,aB as R}from"./index-Bl2lQPd7.js";import{Q as T,a as m}from"./QItem-De3v03wU.js";import{Q as V}from"./QBadge-Bjfo5tRO.js";import{Q as n}from"./QItemLabel-BkJiB6aE.js";import{Q as j}from"./QList-CMzNTEGD.js";import{q as P}from"./date-C1Mon-Jj.js";import"./format-IcNrutKL.js";const S={computed:{...L({user:"user/user",config:"user/config",links:"user/nav",current:"user/current",messagesList:"message/inbox",darkMode:"darkMode"}),messages(){return this.messagesList&&this.messagesList.data?this.messagesList.data:[]},classe(){if(this.current&&this.current.hasOwnProperty("classe"))return this.current.classe},annee(){if(this.current&&this.current.hasOwnProperty("annee"))return this.current.annee},dark:{get(){return this.darkMode},set(r){this.toggleDarkMode()}}},methods:{...y({getConfig:"user/getConfig",getMessages:"message/getInbox"}),LetterAvatar:w,toNow:Q,fileIcon:v,openURL:k,pjUrl:x,personAvatar(r){return R(r)},sub(r){return U(this.$cleanHtml(r,{allowedTags:["b","i","em","strong","a"]}))},date(r){return P.formatDate(r*1e3)}},mounted(){this.getMessages({page:1,filter:{}})}},z=["onClick"];function E(r,H,O,F,G,t){return o(),d(D,{style:{margin:"0 -8px"},flat:""},{default:a(()=>[s(j,null,{default:a(()=>[(o(!0),u(f,null,p(t.messages,(e,h)=>I((o(),d(T,{key:h,clickable:"",to:"/prof/messages/view/"+e.id},{default:a(()=>[s(m,{avatar:""},{default:a(()=>[s(C,null,{default:a(()=>[s(_,{src:t.personAvatar(e.sender),"placeholder-src":t.LetterAvatar(e.sender.nom),ratio:"1"},null,8,["src","placeholder-src"])]),_:2},1024)]),_:2},1024),s(m,null,{default:a(()=>[s(n,{lines:"1"},{default:a(()=>[s(V,{transparent:"",color:"secondary"},{default:a(()=>[i(l(e.type_sender),1)]),_:2},1024),A("span",{class:g({"text-weight-bold":!e.etat.length})}," Â "+l(e.sender.nom)+" "+l(e.sender.prenom),3)]),_:2},1024),s(n,{lines:"1",class:g({"text-weight-bold":!e.etat.length})},{default:a(()=>[i(l(e.objet),1)]),_:2},1032,["class"]),s(n,{caption:"",lines:"1"},{default:a(()=>[i(l(t.sub(e.message)),1)]),_:2},1024),e.fichiers.length?(o(),d(n,{key:0,lines:"1"},{default:a(()=>[(o(!0),u(f,null,p(e.fichiers,(c,Y)=>(o(),u("div",{outline:"",color:"grey-9",onClick:B(J=>t.openURL(t.pjUrl(c)),["prevent"]),class:"ellipsis rounded-borders q-mr-xs q-pa-xs",style:{"max-width":"40%",display:"inline-block",border:"1px solid var(--q-primary)"}},[s(N,{name:"img:"+t.fileIcon(c.fichier),size:"14px"},null,8,["name"]),i(" "+l(c.fichier),1)],8,z))),256))]),_:2},1024)):M("",!0)]),_:2},1024),s(m,{side:"",top:""},{default:a(()=>[s(n,{caption:""},{default:a(()=>[i(l(t.toNow(e.created_at*1e3)),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to"])),[[q]])),128))]),_:1})]),_:1})}const te=b(S,[["render",E]]);export{te as default};
