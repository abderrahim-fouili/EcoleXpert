import{Q as _}from"./QImg-BMvxJu3S.js";import{Q as b}from"./QBadge-Bjfo5tRO.js";import{_ as v,aY as x,b8 as k,b9 as Q,b2 as w,ba as y,as as L,at as I,Q as c,S as l,a6 as a,a5 as t,a4 as u,a9 as f,aa as p,av as C,a7 as M,ad as n,ab as i,R as A,a8 as B,af as g,ah as N,ay as q,aw as D,aE as U,be as R,aB as T}from"./index-Bl2lQPd7.js";import{Q as V,a as m}from"./QItem-De3v03wU.js";import{Q as o}from"./QItemLabel-BkJiB6aE.js";import{Q as j}from"./QList-CMzNTEGD.js";import{q as P}from"./date-C1Mon-Jj.js";import"./format-IcNrutKL.js";const S={computed:{...I({user:"user/user",config:"user/config",links:"user/nav",current:"user/current",messagesList:"message/inbox",darkMode:"darkMode"}),messages(){return this.messagesList&&this.messagesList.data?this.messagesList.data:[]},eleve(){if(this.current&&this.current.hasOwnProperty("eleve"))return this.current.eleve},annee(){if(this.current&&this.current.hasOwnProperty("annee"))return this.current.annee},dark:{get(){return this.darkMode},set(s){this.toggleDarkMode()}}},methods:{...L({getConfig:"user/getConfig",getMessages:"message/getInbox"}),LetterAvatar:y,toNow:w,fileIcon:Q,openURL:k,pjUrl:x,personAvatar(s){return T(s)},sub(s){return R(this.$cleanHtml(s,{allowedTags:["b","i","em","strong","a"]}))},date(s){return P.formatDate(s*1e3)}},mounted(){this.getMessages({page:1,filter:{kids:this.config.meta.eleves.map(s=>s.idpers)}})}},z=["onClick"];function E(s,H,O,F,G,r){return l(),c(U,{style:{margin:"0 -8px"},flat:""},{default:a(()=>[t(j,null,{default:a(()=>[(l(!0),u(f,null,p(r.messages,(e,h)=>C((l(),c(V,{key:h,clickable:"",to:"/messages/view/"+e.id},{default:a(()=>[t(m,{avatar:""},{default:a(()=>[t(M,null,{default:a(()=>[t(_,{src:r.personAvatar(e.sender),"placeholder-src":r.LetterAvatar(e.sender.nom)},null,8,["src","placeholder-src"]),t(b,{floating:"",transparent:"",color:"secondary"},{default:a(()=>[n(i(e.type_sender),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(m,null,{default:a(()=>[t(o,{lines:"1"},{default:a(()=>[B("span",{class:g({"text-weight-bold":!e.etat.length})},i(e.sender.nom)+" "+i(e.sender.prenom),3)]),_:2},1024),t(o,{lines:"1",class:g({"text-weight-bold":!e.etat.length})},{default:a(()=>[n(i(e.objet),1)]),_:2},1032,["class"]),t(o,{caption:"",lines:"1"},{default:a(()=>[n(i(r.sub(e.message)),1)]),_:2},1024),e.fichiers.length?(l(),c(o,{key:0,lines:"1"},{default:a(()=>[(l(!0),u(f,null,p(e.fichiers,(d,Y)=>(l(),u("div",{outline:"",color:"grey-9",onClick:N(J=>r.openURL(r.pjUrl(d)),["prevent"]),class:"ellipsis rounded-borders q-mr-xs q-pa-xs",style:{"max-width":"40%",display:"inline-block",border:"1px solid var(--q-primary)"}},[t(q,{name:"img:"+r.fileIcon(d.fichier),size:"14px"},null,8,["name"]),n(" "+i(d.fichier),1)],8,z))),256))]),_:2},1024)):A("",!0)]),_:2},1024),t(m,{side:"",top:""},{default:a(()=>[t(o,{caption:""},{default:a(()=>[n(i(r.toNow(e.created_at*1e3)),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to"])),[[D]])),128))]),_:1})]),_:1})}const se=v(S,[["render",E]]);export{se as default};
