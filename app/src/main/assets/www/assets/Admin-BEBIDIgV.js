import{Q as k,a as h}from"./QItem-De3v03wU.js";import{Q as C}from"./QList-CMzNTEGD.js";import{Q as N}from"./QMenu-BNr9Tzvf.js";import{_ as W,ar as G,aq as J,as as j,at as K,ag as d,a4 as w,S as n,Q as u,R as f,a5 as e,a6 as t,ad as m,ab as c,a3 as p,a9 as b,aa as V,av as q,aw as A,a8 as a,ax as _,a7 as X,ay as v,af as Q,az as Y,aA as Z,aD as y,h as $,aJ as ee,aB as S}from"./index-Bl2lQPd7.js";import{Q as O}from"./QToolbarTitle-C8APieXG.js";import{Q as z}from"./QBadge-Bjfo5tRO.js";import{Q as x}from"./QItemLabel-BkJiB6aE.js";import{Q as te}from"./QExpansionItem-EMhshZ_3.js";import{Q as oe}from"./QScrollArea-DbARZhEV.js";import{_ as se,Q as le}from"./SchoolSwitcher-D06IRcd0.js";import{Q as ie}from"./QToolbar-DR-_wX4W.js";import{Q as ne}from"./QFooter-BqOQs2Wv.js";import{C as re}from"./ClosePopup-BY_YGFBZ.js";import{E as ae}from"./Header-iKAj_IF4.js";import{N as ue}from"./Notifications-DUxCRqy9.js";import{C as de,S as fe}from"./Contact-BnHMrRuo.js";import{_ as me,U as ce}from"./UserQr-CGAimP3b.js";import{s as M}from"./notif-Ca_8-ZkB.js";import{_ as pe}from"./Espace-7ToSYTXU.js";import"./position-engine-o8Q2RudZ.js";import"./selection-DaBtDCZ0.js";import"./QSlideTransition-CrdUnXBf.js";import"./TouchPan-jBhMORlX.js";import"./touch-BjYP5sR0.js";import"./format-IcNrutKL.js";import"./composables-CAkrP3jA.js";import"./QBanner-xBGiroIy.js";import"./QPageSticky-adQ0nSeI.js";import"./QHeader-B4MlZ-LM.js";import"./QSpace-CKKoNTi_.js";import"./groupBy-BgHPVcz-.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./_curry1-CPMemvwC.js";import"./_xfBase-ZXVHuZFu.js";import"./_reduce-BZMr9wpn.js";import"./_isArrayLike-B3kKjEvQ.js";import"./index-Dx01H97j.js";import"./index-CbPSoDvq.js";import"./QImg-BMvxJu3S.js";const he={name:"MyLayout",data(){return{isFullscreen:!1,settingeDialog:!1,showNotifs:!1,showSortie:!1,showContact:!1,showQr:!1,drawerOpen:this.$q.platform.is.desktop}},components:{UserBg:ce,UserQr:me,EpHeader:ae,Notifications:ue,Sortie:fe,EspaceSwitcher:pe,Contact:de,SchoolSwitcher:se},computed:{...K({user:"user/user",config:"user/config",links:"user/nav",current:"user/current",notificationCounter:"notification/counter",darkMode:"darkMode",title:"title",footer:"footer"}),annees(){return this.config&&this.config.meta.hasOwnProperty("annees")?this.config.meta.annees:[]},annee(){if(this.current&&this.current.hasOwnProperty("annee"))return this.current.annee},dark:{get(){return this.darkMode},set(i){this.toggleDarkMode()}}},methods:{...j({logout:"user/logout",nav:"user/nav",setDefaults:"user/setDefaults",togglAnnee:"user/setAnnee",getEmploi:"emploi/getData",getDevoirs:"devoirs/getDevoirs",setCounter:"notification/setCounter",toggleDarkMode:"toggleDarkMode",getEcoleId:"ecole/getId"}),isDev:J,openURL:G,clearNotifCounter(){this.setCounter(0)},subscribeAll(i){if(this.$q.platform.is.cordova){let o="ecoleplus_"+i;M(o+"_admin"),M(o+"_"+this.user.idpers)}},setAnnee(i){this.togglAnnee(i)},avatar(){return S(this.user)},personAvatar(i){return S(i)},deconnexion(){this.logout(),this.$router.push("/login")},minimize(){},maximize(){},fullscreen(){this.$q.electron.remote.BrowserWindow.getFocusedWindow().setFullScreen(this.isFullscreen=!this.isFullscreen)},close(){}},watch:{annee(){}},created(){ee("admin")},mounted(){this.canAccess(this.config),this.nav(),this.setDefaults(this.config),this.subscribeAll($),this.getEcoleId()}},_e={class:"col-xs-10",style:{position:"relative"}},ge={class:"absolute-top text-white bg1",style:{height:"150px",overflow:"hidden"}},we={class:"absolute-bottom text-center"},be=["src"],ve={class:"text-weight-bold text-white text-shadow q-mb-xl"},ke={class:"col-xs-2 bg-white text-dark q-pt-lg q-pb-lg q-pr-xs",style:{position:"relative"}},Ce={class:"flex flex-center full-width"},Qe={class:"flex flex-center full-width"},ye={class:"flex flex-center full-width"},xe={class:"flex flex-center full-width q-mt-sm"},De={class:"absolute-bottom"},Ve={class:"flex flex-center full-width"};function qe(i,o,Ae,Ne,l,r){const U=d("ep-header"),B=d("user-bg"),F=d("espace-switcher"),I=d("school-switcher"),E=d("router-view"),P=d("notifications"),L=d("sortie"),R=d("contact"),T=d("user-qr");return n(),w(b,null,[i.user?(n(),u(Z,{key:0,view:"hhr lpR fFr",class:Q({page:!0})},{default:t(()=>[e(U,null,{toolbar:t(()=>[r.annees.length&&r.annee?(n(),u(p,{key:0,flat:"",icon:"pending_actions",dark:""},{default:t(()=>[m(c(r.annee.description)+" ",1),e(N,null,{default:t(()=>[e(C,{link:""},{default:t(()=>[(n(!0),w(b,null,V(r.annees,(s,D)=>q((n(),u(k,{clickable:"",key:D,onClick:g=>r.setAnnee(s),active:r.annee.idannee===s.idannee},{default:t(()=>[e(h,null,{default:t(()=>[m(c(s.description),1)]),_:2},1024)]),_:2},1032,["onClick","active"])),[[re],[A]])),128))]),_:1})]),_:1})]),_:1})):f("",!0),e(O),e(p,{onClick:o[0]||(o[0]=s=>i.go("/admin")),flat:"",round:"",dense:"",icon:"icon_home",class:"q-mr-xs"}),e(p,{flat:"",round:"",dense:"",icon:"icon_menu_burger",onClick:o[1]||(o[1]=s=>l.drawerOpen=!l.drawerOpen),"aria-label":"Menu"},{default:t(()=>[i.notificationCounter>0?(n(),u(z,{key:0,color:"warning",floating:""},{default:t(()=>[m(c(i.notificationCounter),1)]),_:1})):f("",!0)]),_:1})]),title:t(()=>[m(c(i.title),1)]),_:1}),e(le,{modelValue:l.drawerOpen,"onUpdate:modelValue":o[6]||(o[6]=s=>l.drawerOpen=s),side:"right",dark:"",elevated:"",class:"bg-secondary row"},{default:t(()=>[a("div",_e,[e(oe,{style:{height:"calc(100% - 150px)","margin-top":"150px"}},{default:t(()=>[e(C,{bordered:""},{default:t(()=>[(n(!0),w(b,null,V(i.links,(s,D)=>(n(),w(b,null,[s.haschildren&&s.items.length?(n(),u(te,{key:0,label:s.label},{default:t(()=>[e(C,{class:"bg-secondary-light rounded-b-xl"},{default:t(()=>[(n(!0),w(b,null,V(s.items,(g,H)=>(n(),w(b,null,[r.isDev()||!g.disable?q((n(),u(k,{clickable:"",to:g.to,key:H,disable:r.isDev()?!1:g.disable,exact:!g.hasOwnProperty("haschildren")},{default:t(()=>[e(h,null,{default:t(()=>[e(x,null,{default:t(()=>[m(c(g.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to","disable","exact"])),[[A]]):f("",!0)],64))),256))]),_:2},1024)]),_:2},1032,["label"])):r.isDev()||!s.disable?q((n(),u(k,{clickable:"",to:s.to,key:D,disable:r.isDev()?!1:s.disable,exact:!s.hasOwnProperty("haschildren")},{default:t(()=>[e(h,null,{default:t(()=>[e(x,null,{default:t(()=>[m(c(s.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to","disable","exact"])),[[A]]):f("",!0),s.disable?f("",!0):(n(),u(_,{key:2}))],64))),256))]),_:1})]),_:1}),a("div",ge,[e(B),a("div",we,[e(X,{size:"56px",class:"q-mb-sm"},{default:t(()=>[a("img",{src:r.avatar(i.user)},null,8,be),e(N,null,{default:t(()=>[e(C,{link:""},{default:t(()=>[e(k,{to:"/personnel",clickable:""},{default:t(()=>[e(h,{side:""},{default:t(()=>[e(v,{name:"account_circle"})]),_:1}),e(h,null,{default:t(()=>[e(x,null,{default:t(()=>o[13]||(o[13]=[m(" Profil ")])),_:1})]),_:1})]),_:1}),e(_),e(k,{onClick:r.deconnexion,clickable:""},{default:t(()=>[e(h,{side:""},{default:t(()=>[e(v,{name:"power_settings_new"})]),_:1}),e(h,null,{default:t(()=>[e(x,null,{default:t(()=>o[14]||(o[14]=[m(" DÃ©connexion ")])),_:1})]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),a("div",ve,c(i.user.nom)+" "+c(i.user.prenom),1)])])]),a("div",ke,[e(p,{class:"full-width q-mb-sm",flat:"",onClick:o[2]||(o[2]=s=>l.drawerOpen=!l.drawerOpen),"aria-label":"Menu"},{default:t(()=>[e(v,{name:"icon_menu_burger"})]),_:1}),a("div",Ce,[e(_,{style:{width:"50%"}})]),e(p,{class:Q({"full-width":!0,"q-mt-sm":!0,greyscale:i.notificationCounter==0}),size:"lg",flat:"",dense:"",onClick:o[3]||(o[3]=s=>l.showNotifs=!l.showNotifs),"aria-label":"Menu"},{default:t(()=>[i.notificationCounter>0?(n(),u(z,{key:0,color:"warning",floating:""},{default:t(()=>[m(c(i.notificationCounter),1)]),_:1})):f("",!0),o[15]||(o[15]=a("img",{src:"/leaf.svg",class:"full-width"},null,-1))]),_:1},8,["class"]),a("div",Qe,[e(_,{style:{width:"50%"}})]),e(p,{flat:"",class:Q({"full-width":!0,"q-mt-sm":!0}),onClick:o[4]||(o[4]=s=>l.showQr=!l.showQr)},{default:t(()=>[e(v,{name:"icon_qr_code"})]),_:1}),a("div",ye,[e(_,{style:{width:"50%"}})]),e(p,{flat:"",class:Q({"full-width":!0,"q-mt-sm":!0}),onClick:o[5]||(o[5]=s=>l.showContact=!l.showContact)},{default:t(()=>[e(v,{name:"icon_uniF2C3"})]),_:1}),a("div",xe,[e(_,{style:{width:"50%"}})]),e(F),e(I),a("div",De,[a("div",Ve,[e(_,{style:{width:"50%"}})]),e(p,{onClick:r.deconnexion,color:"red",flat:"",size:"lg",class:"full-width"},{default:t(()=>[e(v,{name:"power_settings_new"})]),_:1},8,["onClick"])])])]),_:1},8,["modelValue"]),e(Y,null,{default:t(()=>[r.annee?(n(),u(E,{key:0})):f("",!0)]),_:1}),i.footer?(n(),u(ne,{key:0,class:"bg-secondary"},{default:t(()=>[e(ie,null,{default:t(()=>[e(O,null,{default:t(()=>[e(p,{icon:"icon_retour_mobile",flat:"",onClick:o[7]||(o[7]=s=>i.$router.go(-1))})]),_:1}),o[16]||(o[16]=a("div",{id:"footer-portal"},null,-1))]),_:1})]),_:1})):f("",!0)]),_:1})):f("",!0),e(y,{modelValue:l.showNotifs,"onUpdate:modelValue":o[9]||(o[9]=s=>l.showNotifs=s),position:"right",maximized:"",onHide:r.clearNotifCounter},{default:t(()=>[e(P,{"onNotif:close":o[8]||(o[8]=s=>{l.showNotifs=!1,l.drawerOpen=!1})})]),_:1},8,["modelValue","onHide"]),e(y,{modelValue:l.showSortie,"onUpdate:modelValue":o[10]||(o[10]=s=>l.showSortie=s),position:"right",maximized:""},{default:t(()=>[e(L)]),_:1},8,["modelValue"]),e(y,{modelValue:l.showContact,"onUpdate:modelValue":o[11]||(o[11]=s=>l.showContact=s),position:"right",maximized:""},{default:t(()=>[e(R)]),_:1},8,["modelValue"]),e(y,{modelValue:l.showQr,"onUpdate:modelValue":o[12]||(o[12]=s=>l.showQr=s),position:"right",maximized:""},{default:t(()=>[e(T)]),_:1},8,["modelValue"])],64)}const _t=W(he,[["render",qe]]);export{_t as default};
