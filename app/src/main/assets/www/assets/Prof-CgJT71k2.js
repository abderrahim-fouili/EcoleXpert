import{Q as v,a as h}from"./QItem-De3v03wU.js";import{Q}from"./QList-CMzNTEGD.js";import{Q as N}from"./QMenu-BNr9Tzvf.js";import{_ as G,ar as J,aq as j,as as K,at as X,ag as c,a4 as w,S as a,Q as u,R as d,a5 as e,a6 as t,ad as m,ab as p,a3 as f,a9 as g,aa as y,av as x,aw as D,a8 as i,ax as b,a7 as Y,ay as k,af as q,az as Z,aA as $,aD as V,h as ee,aJ as te,aB as F}from"./index-Bl2lQPd7.js";import{Q as M}from"./QToolbarTitle-C8APieXG.js";import{Q as O}from"./QBadge-Bjfo5tRO.js";import{Q as A}from"./QItemLabel-BkJiB6aE.js";import{Q as se}from"./QExpansionItem-EMhshZ_3.js";import{Q as le}from"./QScrollArea-DbARZhEV.js";import{_ as oe,Q as re}from"./SchoolSwitcher-D06IRcd0.js";import{Q as ne}from"./QToolbar-DR-_wX4W.js";import{Q as ae}from"./QFooter-BqOQs2Wv.js";import{Q as ie}from"./QPullToRefresh-BShZwV52.js";import{C as z}from"./ClosePopup-BY_YGFBZ.js";import{E as ue}from"./Header-iKAj_IF4.js";import{N as de}from"./Notifications-DUxCRqy9.js";import{C as fe,S as ce}from"./Contact-BnHMrRuo.js";import{s as S}from"./notif-Ca_8-ZkB.js";import{_ as me}from"./Espace-7ToSYTXU.js";import{U as pe,_ as he}from"./UserQr-CGAimP3b.js";import"./position-engine-o8Q2RudZ.js";import"./selection-DaBtDCZ0.js";import"./QSlideTransition-CrdUnXBf.js";import"./TouchPan-jBhMORlX.js";import"./touch-BjYP5sR0.js";import"./format-IcNrutKL.js";import"./composables-CAkrP3jA.js";import"./QBanner-xBGiroIy.js";import"./QPageSticky-adQ0nSeI.js";import"./QHeader-B4MlZ-LM.js";import"./QSpace-CKKoNTi_.js";import"./groupBy-BgHPVcz-.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./_curry1-CPMemvwC.js";import"./_xfBase-ZXVHuZFu.js";import"./_reduce-BZMr9wpn.js";import"./_isArrayLike-B3kKjEvQ.js";import"./index-Dx01H97j.js";import"./index-CbPSoDvq.js";import"./QImg-BMvxJu3S.js";const _e={name:"MyLayout",data(){return{isFullscreen:!1,settingeDialog:!1,showNotifs:!1,showSortie:!1,showContact:!1,showQr:!1,drawerOpen:this.$q.platform.is.desktop}},components:{EpHeader:ue,Notifications:de,Sortie:ce,EspaceSwitcher:me,Contact:fe,SchoolSwitcher:oe,UserQr:he,UserBg:pe},computed:{...X({user:"user/user",config:"user/config",links:"user/nav",current:"user/current",notificationCounter:"notification/counter",darkMode:"darkMode",title:"title",footer:"footer",refreshFunction:"refresh"}),classe(){if(this.current&&this.current.hasOwnProperty("classe"))return this.current.classe},annee(){if(this.current&&this.current.hasOwnProperty("annee"))return this.current.annee},dark:{get(){return this.darkMode},set(o){this.toggleDarkMode()}}},methods:{...K({logout:"user/logout",nav:"user/nav",setDefaults:"user/setDefaults",togglAnnee:"user/setAnnee",toggleClasse:"user/setClasse",getEmploi:"profEmploi/getData",getDevoirs:"devoirs/getDevoirs",setCounter:"notification/setCounter",toggleDarkMode:"toggleDarkMode"}),isDev:j,openURL:J,refresh(o){this.refreshFunction?this.refreshFunction(o):o()},uniqAnnees(o){return[...new Map(o.map(s=>[s.idannee,s])).values()]},clearNotifCounter(){this.setCounter(0)},subscribeAll(o){if(this.$q.platform.is.cordova){let s="ecoleplus_"+o;S(s+"_prof"),S(s+"_prof_"+this.user.idpers),S(s+"_"+this.user.idpers)}},setClasse(o){this.toggleClasse(o)},setAnnee(o){this.togglAnnee(o)},avatar(){return F(this.user)},personAvatar(o){return F(o)},deconnexion(){this.logout(),this.$router.push("/login")},minimize(){},maximize(){},fullscreen(){this.$q.electron.remote.BrowserWindow.getFocusedWindow().setFullScreen(this.isFullscreen=!this.isFullscreen)},close(){}},watch:{annee(){this.getEmploi({annee:this.annee.idannee,classe:this.classe.idclasse})}},created(){te("prof")},mounted(){this.canAccess(this.config),this.nav(),this.setDefaults(this.config),this.subscribeAll(ee)}},we={class:"col-xs-10",style:{position:"relative"}},ge={class:"absolute-top text-white bg1",style:{height:"150px",overflow:"hidden"}},be={class:"absolute-bottom text-center"},ve=["src"],ke={class:"text-weight-bold text-white text-shadow q-mb-xl"},Ce={class:"col-xs-2 bg-white text-dark q-pt-lg q-pb-lg q-pr-xs",style:{position:"relative"}},Qe={class:"flex flex-center full-width"},ye={class:"flex flex-center full-width"},xe={class:"flex flex-center full-width"},De={class:"flex flex-center full-width q-mt-sm"},qe={class:"absolute-bottom"},Ve={class:"flex flex-center full-width"};function Ae(o,s,Ne,Se,r,n){const P=c("ep-header"),U=c("user-bg"),B=c("espace-switcher"),E=c("school-switcher"),R=c("router-view"),I=c("notifications"),L=c("sortie"),T=c("contact"),H=c("user-qr");return a(),w(g,null,[o.user?(a(),u($,{key:0,view:"hhr lpR fFr",class:q({page:!0})},{default:t(()=>[e(ie,{onRefresh:n.refresh},{default:t(()=>[e(P,null,{toolbar:t(()=>[n.classe?(a(),u(f,{key:0,flat:"",dense:"",icon:"icon_pour_classe",label:n.classe.classe_fr,dark:""},{default:t(()=>[e(N,null,{default:t(()=>[e(Q,{flat:""},{default:t(()=>[(a(!0),w(g,null,y(o.config.meta.annees,(l,C)=>x((a(),u(v,{clickable:"",key:C,onClick:_=>n.setClasse(l),active:n.classe.idclasse===l.idclasse},{default:t(()=>[e(h,null,{default:t(()=>[m(p(l.classe_fr),1)]),_:2},1024)]),_:2},1032,["onClick","active"])),[[z],[D]])),128))]),_:1})]),_:1})]),_:1},8,["label"])):d("",!0),n.annee?(a(),u(f,{key:1,flat:"",dense:"",icon:"pending_actions",label:n.annee.description,dark:""},{default:t(()=>[e(N,null,{default:t(()=>[e(Q,{link:""},{default:t(()=>[(a(!0),w(g,null,y(n.uniqAnnees(n.classe.annees),(l,C)=>x((a(),u(v,{clickable:"",key:C,onClick:_=>n.setAnnee(l),active:n.annee.idannee===l.idannee},{default:t(()=>[e(h,null,{default:t(()=>[m(p(l.description),1)]),_:2},1024)]),_:2},1032,["onClick","active"])),[[z],[D]])),128))]),_:1})]),_:1})]),_:1},8,["label"])):d("",!0),e(M),e(f,{onClick:s[0]||(s[0]=l=>o.go("/prof")),flat:"",round:"",dense:"",icon:"icon_home",class:"q-mr-xs"}),e(f,{flat:"",round:"",dense:"",icon:"icon_menu_burger",onClick:s[1]||(s[1]=l=>r.drawerOpen=!r.drawerOpen),"aria-label":"Menu"},{default:t(()=>[o.notificationCounter>0?(a(),u(O,{key:0,color:"warning",floating:""},{default:t(()=>[m(p(o.notificationCounter),1)]),_:1})):d("",!0)]),_:1})]),title:t(()=>[m(p(o.title),1)]),_:1}),e(re,{modelValue:r.drawerOpen,"onUpdate:modelValue":s[6]||(s[6]=l=>r.drawerOpen=l),side:"right",dark:"",elevated:"",class:"bg-secondary row"},{default:t(()=>[i("div",we,[e(le,{style:{height:"calc(100% - 150px)","margin-top":"150px"}},{default:t(()=>[e(Q,{bordered:""},{default:t(()=>[(a(!0),w(g,null,y(o.links,(l,C)=>(a(),w(g,null,[l.haschildren&&l.items.length?(a(),u(se,{key:0,label:l.label},{default:t(()=>[e(Q,null,{default:t(()=>[(a(!0),w(g,null,y(l.items,(_,W)=>(a(),w(g,null,[n.isDev()||!_.disable?x((a(),u(v,{clickable:"",to:_.to,key:W,disable:n.isDev()?!1:_.disable,exact:!_.hasOwnProperty("haschildren")},{default:t(()=>[e(h,null,{default:t(()=>[e(A,null,{default:t(()=>[m(p(_.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to","disable","exact"])),[[D]]):d("",!0)],64))),256))]),_:2},1024)]),_:2},1032,["label"])):n.isDev()||!l.disable?x((a(),u(v,{clickable:"",to:l.to,key:C,disable:n.isDev()?!1:l.disable,exact:!l.hasOwnProperty("haschildren")},{default:t(()=>[e(h,null,{default:t(()=>[e(A,null,{default:t(()=>[m(p(l.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to","disable","exact"])),[[D]]):d("",!0),l.disable?d("",!0):(a(),u(b,{key:2}))],64))),256))]),_:1})]),_:1}),i("div",ge,[e(U),i("div",be,[e(Y,{size:"56px",class:"q-mb-sm"},{default:t(()=>[i("img",{src:n.avatar(o.user)},null,8,ve),e(N,null,{default:t(()=>[e(Q,{link:""},{default:t(()=>[e(v,{to:"/personnel",clickable:""},{default:t(()=>[e(h,{side:""},{default:t(()=>[e(k,{name:"account_circle"})]),_:1}),e(h,null,{default:t(()=>[e(A,null,{default:t(()=>s[13]||(s[13]=[m(" Profil ")])),_:1})]),_:1})]),_:1}),e(b),e(v,{onClick:n.deconnexion,clickable:""},{default:t(()=>[e(h,{side:""},{default:t(()=>[e(k,{name:"power_settings_new"})]),_:1}),e(h,null,{default:t(()=>[e(A,null,{default:t(()=>s[14]||(s[14]=[m(" DÃ©connexion ")])),_:1})]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),i("div",ke,p(o.user.nom)+" "+p(o.user.prenom),1)])])]),i("div",Ce,[e(f,{class:"full-width q-mb-sm",flat:"",onClick:s[2]||(s[2]=l=>r.drawerOpen=!r.drawerOpen),"aria-label":"Menu"},{default:t(()=>[e(k,{name:"icon_menu_burger"})]),_:1}),i("div",Qe,[e(b,{style:{width:"50%"}})]),e(f,{class:q({"full-width":!0,"q-mt-sm":!0,greyscale:o.notificationCounter==0}),size:"lg",flat:"",dense:"",onClick:s[3]||(s[3]=l=>r.showNotifs=!r.showNotifs),"aria-label":"Menu"},{default:t(()=>[o.notificationCounter>0?(a(),u(O,{key:0,color:"warning",floating:""},{default:t(()=>[m(p(o.notificationCounter),1)]),_:1})):d("",!0),s[15]||(s[15]=i("img",{src:"/leaf.svg",class:"full-width"},null,-1))]),_:1},8,["class"]),i("div",ye,[e(b,{style:{width:"50%"}})]),e(f,{flat:"",class:q({"full-width":!0,"q-mt-sm":!0}),onClick:s[4]||(s[4]=l=>r.showQr=!r.showQr)},{default:t(()=>[e(k,{name:"icon_qr_code"})]),_:1}),i("div",xe,[e(b,{style:{width:"50%"}})]),e(f,{flat:"",class:q({"full-width":!0,"q-mt-sm":!0}),onClick:s[5]||(s[5]=l=>r.showContact=!r.showContact)},{default:t(()=>[e(k,{name:"icon_uniF2C3"})]),_:1}),i("div",De,[e(b,{style:{width:"50%"}})]),e(B),e(E),i("div",qe,[i("div",Ve,[e(b,{style:{width:"50%"}})]),e(f,{onClick:n.deconnexion,color:"red",flat:"",size:"lg",class:"full-width"},{default:t(()=>[e(k,{name:"power_settings_new"})]),_:1},8,["onClick"])])])]),_:1},8,["modelValue"]),e(Z,null,{default:t(()=>[n.annee&&n.classe?(a(),u(R,{key:0})):d("",!0)]),_:1}),o.footer?(a(),u(ae,{key:0,class:"bg-secondary"},{default:t(()=>[e(ne,null,{default:t(()=>[e(M,null,{default:t(()=>[e(f,{icon:"icon_retour_mobile",flat:"",onClick:s[7]||(s[7]=l=>o.$router.go(-1))})]),_:1}),s[16]||(s[16]=i("div",{id:"footer-portal"},null,-1))]),_:1})]),_:1})):d("",!0)]),_:1},8,["onRefresh"])]),_:1})):d("",!0),e(V,{modelValue:r.showNotifs,"onUpdate:modelValue":s[9]||(s[9]=l=>r.showNotifs=l),position:"right",maximized:"",onHide:n.clearNotifCounter},{default:t(()=>[e(I,{"onNotif:close":s[8]||(s[8]=l=>{r.showNotifs=!1,r.drawerOpen=!1})})]),_:1},8,["modelValue","onHide"]),e(V,{modelValue:r.showSortie,"onUpdate:modelValue":s[10]||(s[10]=l=>r.showSortie=l),position:"right",maximized:""},{default:t(()=>[e(L)]),_:1},8,["modelValue"]),e(V,{modelValue:r.showContact,"onUpdate:modelValue":s[11]||(s[11]=l=>r.showContact=l),position:"right",maximized:""},{default:t(()=>[e(T)]),_:1},8,["modelValue"]),e(V,{modelValue:r.showQr,"onUpdate:modelValue":s[12]||(s[12]=l=>r.showQr=l),position:"right",maximized:""},{default:t(()=>[e(H)]),_:1},8,["modelValue"])],64)}const gt=G(_e,[["render",Ae]]);export{gt as default};
