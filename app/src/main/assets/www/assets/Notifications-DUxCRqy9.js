import{Q as w}from"./QSpace-CKKoNTi_.js";import{_ as Q,b2 as D,bb as C,as as k,at as x,cn as o,ag as N,Q as d,S as l,a6 as i,a5 as s,a8 as U,R as h,aF as A,av as V,a3 as S,ad as n,ab as u,a4 as m,ax as _,a9 as g,aa as B,af as b,a7 as I,ay as R,aE as q,h as v}from"./index-Bl2lQPd7.js";import{Q as M,a as c}from"./QItem-De3v03wU.js";import{Q as f}from"./QItemLabel-BkJiB6aE.js";import{Q as P}from"./QList-CMzNTEGD.js";import{C as $}from"./ClosePopup-BY_YGFBZ.js";import{g as L}from"./groupBy-BgHPVcz-.js";import{f as O}from"./index-Dx01H97j.js";const E={props:{},watch:{notifCounter(){this.paginatedData()}},data(){return{filter:{status:1,topics:[]}}},computed:{...x({user:"user/user",config:"user/config",current:"user/current",data:"notification/data",notifCounter:"notification/counter"}),baseUrl(){if(this.config.roles.eleve)return"/eleve/";if(this.config.roles.parent)return this.config.roles.prof&&o==="prof"?"/prof/":this.config.roles.admin&&o==="admin"?"/admin/":"/";if(this.config.roles.prof)return"/prof/";if(this.config.roles.admin)return"/admin/"},byDate(){let e=L(t=>t.rendre_le,this.devoirs);return console.log(e),e},eleve(){if(this.current&&this.current.hasOwnProperty("eleve"))return this.current.eleve},annee(){if(this.current&&this.current.hasOwnProperty("annee"))return this.current.annee}},methods:{...k({getData:"notification/getData"}),isArabic:C,toNow:D,brdr(e){return e.title.includes("Retard de paiement")?{"brd-retard-payement":!0,"shadow-1":!0}:null},color(e){return e.title.includes("Retard de paiement")?"negative":"primary"},icon(e){return e.title.includes("Messagerie")?"icon_discussion_cours":e.title.includes("Retard de paiement")?"icon_exclamation_sign":e.title.includes("Info")?"icon_info_sign":e.title.includes("Devoir")?"icon_exercice_numerique":e.title.includes("Absence")?"icon_absences":e.title.includes("Retard")?"icon_retard":e.title.includes("Anniversaire")?"icon_anniversaire":"icon_bell"},toDate(e){return O(e)},paginatedData(){let e="ecoleplus_"+v,t=[];t.push(e+"_"+this.user.idpers),this.config.roles.parent?(t.push(e+"_parent"),t.push(e+"_"+this.eleve.idpers)):this.config.roles.eleve?(this.filter.not={title:["Messagerie","Absence"]},t.push(e+"_eleve")):(this.filter.not=null,this.filter.topics=[]),this.filter.topics=t,this.getData({page:this.data.current_page,filter:this.filter})},open(e){if(e.title.includes("Messagerie"))if(e.data){let t=JSON.parse(e.data);this.$router.push(this.baseUrl+"messages/view/"+t.model.id)}else this.$router.push(this.baseUrl+"messages");else e.title.includes("Devoir")?this.$router.push(this.baseUrl+"devoirs"):e.title.includes("Actual")?this.$router.push(this.baseUrl+"actualites"):e.title.includes("Documents")&&this.$router.push(this.baseUrl+"documents");this.$emit("notif:close")}},mounted(){let e="ecoleplus_"+v,t=[];t.push(e+"_"+this.user.idpers),this.config.roles.parent?this.config.roles.prof&&o==="prof"?(t.push(e+"_prof"),t.push(e+"_prof_"+this.user.idpers)):this.config.roles.admin&&o==="admin"?(t.push(e+"_admin"),t.push(e+"_admin_"+this.user.idpers)):(t.push(e+"_parent"),t.push(e+"_"+this.eleve.idpers)):this.config.roles.prof?(t.push(e+"_prof"),t.push(e+"_prof_"+this.user.idpers)):this.config.roles.admin?(t.push(e+"_admin"),t.push(e+"_admin_"+this.user.idpers)):this.config.roles.eleve?(this.filter.not={title:["Messagerie","Absence"]},t.push(e+"_eleve")):(this.filter.not=null,this.filter.topics=[]),this.filter.topics=t,this.getData({page:1,filter:this.filter})}},F={class:"q-pr-md q-pl-md q-pb-lg flex flex-center"};function T(e,t,z,G,J,a){const y=N("ep-pagination");return l(),d(q,{style:{width:"100vw"}},{default:i(()=>[s(A,{class:"row"},{default:i(()=>[s(w),V(s(S,{icon:"close",flat:"",round:"",dense:""},null,512),[[$]])]),_:1}),U("div",F,[e.data?(l(),d(y,{key:0,modelValue:e.data.current_page,"onUpdate:modelValue":[t[0]||(t[0]=r=>e.data.current_page=r),a.paginatedData],max:e.data.last_page,"direction-links":"","boundary-links":!1,div:"",divClass:"full-width text-center text-white text-bold",dark:"",color:"white",class:"bg-primary full-width",style:{"border-radius":"10rem",height:"30px"}},{content:i(()=>[n(" Page "+u(e.data.current_page),1)]),_:1},8,["modelValue","max","onUpdate:modelValue"])):h("",!0)]),e.data?(l(),d(P,{key:0},{default:i(()=>[s(_),(l(!0),m(g,null,B(e.data.data,(r,p)=>(l(),m(g,{key:"alarm"+p},[s(M,{clickable:"",onClick:j=>a.open(r),class:b(a.brdr(r))},{default:i(()=>[s(c,{avatar:""},{default:i(()=>[s(I,null,{default:i(()=>[s(R,{name:a.icon(r),color:a.color(r)},null,8,["name","color"])]),_:2},1024)]),_:2},1024),s(c,{class:b({"text-bold":p<e.notifCounter&&e.data.current_page==1})},{default:i(()=>[s(f,{style:{"font-weight":"500"}},{default:i(()=>[n(u(r.title),1)]),_:2},1024),s(f,null,{default:i(()=>[n(u(r.body),1)]),_:2},1024)]),_:2},1032,["class"]),s(c,{side:"",top:"",style:{position:"relative"}},{default:i(()=>[s(f,{caption:"",line:"1"},{default:i(()=>[n(u(a.toNow(a.toDate(r.created_at))),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick","class"]),s(_)],64))),128))]),_:1})):h("",!0)]),_:1})}const se=Q(E,[["render",T]]);export{se as N};
