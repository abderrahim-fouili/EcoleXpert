import{Q as q}from"./QBadge-Bjfo5tRO.js";import{_ as P,aY as N,b8 as G,cR as se,cS as le,b4 as re,as as A,at as M,aB as S,b5 as ie,cT as oe,aW as ae,J as ne,a4 as f,S as o,a5 as t,a6 as s,af as H,av as F,a3 as h,ad as u,ab as m,b6 as ye,aF as W,R as g,a8 as v,a2 as B,a9 as p,aa as k,ay as C,Q as c,b7 as be,aG as de,aE as T,aD as R,b9 as ue,b2 as fe,ba as ce,dv as we,ax as D,ah as K,a7 as Z,aV as $,ar as ke,aK as Ve,ag as x,ac as Ce,aC as De}from"./index-Bl2lQPd7.js";import{Q as b}from"./QItemLabel-BkJiB6aE.js";import{Q as ee,a as w}from"./QItem-De3v03wU.js";import{Q as he}from"./QImg-BMvxJu3S.js";import{Q as me}from"./QExpansionItem-EMhshZ_3.js";import{Q as J}from"./QList-CMzNTEGD.js";import{Q as j}from"./QToolbar-DR-_wX4W.js";import{Q as pe}from"./QVideo-CbIcEHVn.js";import{C as L}from"./ClosePopup-BY_YGFBZ.js";import{q as Fe}from"./format-IcNrutKL.js";import{Q as Y}from"./QToolbarTitle-C8APieXG.js";import{Q as Ue}from"./QSelect-DchnWyXK.js";import{Q as O}from"./QTooltip-r7WoEuzy.js";import{Q as Qe}from"./QUploaderAddTrigger-OZIUWg9a.js";import{Q as xe}from"./QUploader-Dwk8_y__.js";import{Q as ve}from"./QForm-Dk45GsL9.js";import{g as ge}from"./index-CCBxiyaS.js";import{f as z}from"./index-C9ZTL5MN.js";import{f as te}from"./index-Dx01H97j.js";import"./QSlideTransition-CrdUnXBf.js";import"./QChip-C9OfA2gn.js";import"./QMenu-BNr9Tzvf.js";import"./position-engine-o8Q2RudZ.js";import"./selection-DaBtDCZ0.js";import"./rtl-DFPa-2ov.js";import"./QCircularProgress-C_b7NmsY.js";import"./index-BXMW6yyY.js";import"./index-CbPSoDvq.js";const qe={emits:["devoir:edit","devoir:remove","devoir:hold","devoir:sent","devoir:error"],data(){return{cfiles:0,videoDialog:!1,video:null}},props:{title:{default:()=>"Nouvelle ressource"}},computed:{...M({user:"user/user",config:"user/config",current:"user/current",form:"devoirs/form"}),uploadFields(){return[{name:"notReponse",value:!0}]},classe(){if(this.current&&this.current.hasOwnProperty("classe"))return this.current.classe},options(){return this.classes},classes(){return this.current&&this.current.hasOwnProperty("classes")?this.current.classes:[]},annee(){if(this.current&&this.current.hasOwnProperty("annee"))return this.current.annee},headers(){return[{name:"Authorization",value:ne.defaults.headers.common.Authorization}]},url(){return ae("api")+"/devoirs/pj"}},methods:{...A({create:"devoirs/create",update:"devoirs/update"}),isDate:re,ytbUrls:le,imgFormVid:se,openURL:G,pjUrl:N,playVideo(e){this.video=null,this.video="https://www.youtube.com/embed/"+oe(e[0])+"?rel=0",this.videoDialog=!0},minDate(e){return e>=z(new Date,"yyyy/MM/dd")},isImage(e){return ie(this.fileUrl(e))},fileUrl(e){return N(e)},personAvatar(e){return S(e)},added(e){this.cfiles=e.length},removed(e){this.cfiles-=e.length},attach(){this.$nextTick(()=>{this.$refs.uploader.pickFiles()})},send(){this.$refs.form.validate().then(e=>{if(!e)return this.$q.notify({color:"negative",message:this.$t("stats.fields"),position:"bottom",icon:"error_outline",actions:[{label:this.$q.lang.label.close,color:"yellow"}]}),!1;this.cfiles>0?this.$refs.uploader.upload():this.sendMessage()})},sendMessage(e){let l=[],n=Object.assign({},this.form);n.fichiers=[],e&&(l=JSON.parse(e.xhr.response).result),n.idannee=this.annee.idannee,n.rendre_le=ge(new Date)/1e3,n.personne_id=this.user.idpers,n.type=1;let V={files:l,...n};this.form.id?this.update(V).then(a=>{this.$emit("devoir:sent",{d:a,isNew:!1})}).catch(a=>{this.$q.notify({color:"negative",message:this.$t("stats.fields"),position:"bottom",icon:"error_outline",actions:[{label:this.$q.lang.label.close,color:"yellow"}]}),this.$emit("devoir:error",a)}):this.create(V).then(a=>{this.$emit("devoir:sent",{d:a,isNew:!0})}).catch(a=>{this.$q.notify({color:"negative",message:this.$t("stats.fields"),position:"bottom",icon:"error_outline",actions:[{label:this.$q.lang.label.close,color:"yellow"}]}),this.$emit("devoir:error",a)})},choice(e){this.step=e.value.step,this.$nextTick(()=>{if(this.form.destinataire=this.destinataire.map(n=>n.value.idpers?{type:"personne",id:n.value.idpers,value:"personne_"+n.value.idpers,label:n.label}:n),this.step!=="personnes"&&e.value.value)this.destinataire=null,this.setOptions(),this.$refs.dest.refresh(),this.steps.push(e.value);else if(e.value.value===0)for(var l=0;l<this.steps.length;l++)this.steps[l].step===e.value.step&&delete this.steps[l]})},clear(){this.destinataire=null,this.step=null,this.steps=[],this.setOptions()},hasDiscs(e){return e.value.disciplines&&e.value.disciplines.length},discs(e){return e.value.disciplines[0].description}},activated(){this.cfiles=this.form.fichiers.length}},Re={key:0,class:"row"},Ne={class:"row"},je={class:"col-xs-12"},Le={class:"row no-wrap items-center q-pa-sm q-gutter-xs",style:{}},Oe={class:"col"},ze={class:"q-uploader__subtitle"},Pe={class:"full-width"};function Ae(e,l,n,V,a,r){return o(),f(p,null,[t(T,null,{default:s(()=>[t(j,{class:H({"bg-secondary":!e.form.status,"bg-positive":e.form.status,"text-white":!0,"shadow-2":!0})},{default:s(()=>[F(t(h,{flat:"",dense:"",icon:"arrow_back"},null,512),[[L]]),t(Y,null,{default:s(()=>[u(m(n.title),1)]),_:1}),t(h,{flat:"",dense:"",icon:"attach_file",onClick:r.attach,disable:!!e.form.status},{default:s(()=>[F(t(q,{floating:"",color:"yellow-9"},{default:s(()=>[u(m(a.cfiles),1)]),_:1},512),[[ye,a.cfiles>0]])]),_:1},8,["onClick","disable"]),t(h,{class:"q-ml-lg",flat:"",icon:"send",onClick:r.send,disable:!!e.form.status},null,8,["onClick","disable"])]),_:1},8,["class"]),t(W,{style:{"overflow-y":"scroll"}},{default:s(()=>[t(ve,{class:"q-gutter-lg",ref:"form"},{default:s(()=>[t(Ue,{filled:"",modelValue:e.form.classes,"onUpdate:modelValue":l[0]||(l[0]=i=>e.form.classes=i),multiple:"",options:r.options,rules:[i=>i.length>0||"Champ requis"],label:"Classes","emit-value":"","option-value":"idclasse","option-label":"classe_fr","map-options":""},null,8,["modelValue","options","rules"]),t(B,{filled:"",modelValue:e.form.objet,"onUpdate:modelValue":l[1]||(l[1]=i=>e.form.objet=i),label:"Objet",rules:[i=>!!i||"Champ requis"],"lazy-rules":""},null,8,["modelValue","rules"]),t(B,{filled:"",modelValue:e.form.descriptif,"onUpdate:modelValue":l[2]||(l[2]=i=>e.form.descriptif=i),autogrow:"",type:"textarea",label:"Descriptif","lazy-rules":"","input-style":"min-height:150px"},null,8,["modelValue"]),e.form.descriptif&&r.ytbUrls(e.form.descriptif).length?(o(),f("div",Re,[(o(!0),f(p,null,k(r.ytbUrls(e.form.descriptif),(i,U)=>(o(),f("div",{key:"vid-"+U,class:"col-3"},[t(he,{ratio:16/9,src:r.imgFormVid(i[0]),onClick:_=>r.playVideo(i)},{default:s(()=>[t(C,{class:"absolute-center all-pointer-events",size:"32px",name:"play_circle",color:"white"})]),_:2},1032,["src","onClick"])]))),128))])):g("",!0),v("div",Ne,[v("div",je,[t(xe,{"field-name":i=>"pieces_jointe[]",style:{width:"100%"},url:r.url,flat:"",multiple:"",headers:r.headers,"form-fields":r.uploadFields,ref:"uploader",batch:"",onAdded:r.added,onRemoved:r.removed,onUploaded:r.sendMessage},{header:s(i=>[v("div",Le,[i.queuedFiles.length>0?(o(),c(h,{key:0,icon:"clear_all",onClick:i.removeQueuedFiles,round:"",dense:"",flat:""},{default:s(()=>[t(O,null,{default:s(()=>l[4]||(l[4]=[u("Supprimer tous")])),_:1})]),_:2},1032,["onClick"])):g("",!0),i.uploadedFiles.length>0?(o(),c(h,{key:1,icon:"done_all",onClick:i.removeUploadedFiles,round:"",dense:"",flat:""},{default:s(()=>[t(O,null,{default:s(()=>l[5]||(l[5]=[u("Supprimer")])),_:1})]),_:2},1032,["onClick"])):g("",!0),i.isUploading?(o(),c(be,{key:2,class:"q-uploader__spinner"})):g("",!0),v("div",Oe,[l[6]||(l[6]=v("div",{class:"q-uploader__title"},"Pieces Jointe",-1)),v("div",ze,m(i.uploadSizeLabel)+" / "+m(i.uploadProgressLabel),1)]),i.canAddFiles?(o(),c(h,{key:3,type:"a",icon:"add_box",round:"",dense:"",flat:""},{default:s(()=>[t(Qe),t(O,null,{default:s(()=>l[7]||(l[7]=[u("Ajouter des fichiers")])),_:1})]),_:1})):g("",!0),i.isUploading?(o(),c(h,{key:4,icon:"clear",onClick:i.abort,round:"",dense:"",flat:""},{default:s(()=>[t(O,null,{default:s(()=>l[8]||(l[8]=[u("Annuler")])),_:1})]),_:2},1032,["onClick"])):g("",!0)])]),_:1},8,["url","headers","form-fields","onAdded","onRemoved","onUploaded"])])])]),_:1},512)]),_:1}),t(de,{align:"right",class:""},{default:s(()=>[t(h,{label:"Envoyer",icon:"send",onClick:r.send,disable:!!e.form.status},null,8,["onClick","disable"])]),_:1})]),_:1}),t(R,{modelValue:a.videoDialog,"onUpdate:modelValue":l[3]||(l[3]=i=>a.videoDialog=i)},{default:s(()=>[t(j,{class:"text-white fixed-top"},{default:s(()=>[F(t(h,{flat:"",dense:"",icon:"arrow_back"},null,512),[[L]])]),_:1}),v("div",Pe,[t(pe,{src:a.video,ratio:16/9,frameborder:"0",allowfullscreen:"allowfullscreen"},null,8,["src"])])]),_:1},8,["modelValue"])],64)}const Me=P(qe,[["render",Ae]]),Se={props:["devoir"],data(){return{nonfait:[]}},computed:{...M({reponses:"devoirs/reponses",user:"user/user",config:"user/config",current:"user/current",nonFait:"devoirs/nonFait"}),classe(){if(this.current&&this.current.hasOwnProperty("classe"))return this.current.classe},annee(){if(this.current&&this.current.hasOwnProperty("annee"))return this.current.annee}},methods:{...we({setReponse:"devoirs/setDevoirsReponses"}),...A({getReponses:"devoirs/getReponsesProf",saveNonFait:"devoirs/saveNonFait",getNonFait:"devoirs/nonFait"}),userPhotoUrl:S,LetterAvatar:ce,toNow:fe,fileIcon:ue,openURL:G,pjUrl:N,saveNonfait(){this.saveNonFait({annee:this.annee.idannee,classe:this.classe.idclasse,devoir:this.devoir.id,nonfait:this.nonfait}).then(e=>{this.loadNonFait()})},loadNonFait(){this.getNonFait({annee:this.annee.idannee,classe:this.classe.idclasse,devoir:this.devoir.id}).then(e=>{this.nonfait=e.map(l=>l.eleve_id)})}},mounted(){this.setReponse([]),this.getReponses({annee:this.annee.idannee,classe:this.classe.idclasse,devoir:this.devoir.id}).then(()=>{this.loadNonFait()})}},Te=["src"],Ie=["onClick"],Ee=["src"];function Be(e,l,n,V,a,r){return o(),c(T,null,{default:s(()=>[t(j,{class:H({"bg-secondary":!0,"text-white":!0,"shadow-2":!0})},{default:s(()=>[F(t(h,{flat:"",dense:"",icon:"arrow_back"},null,512),[[L]]),t(Y,null,{default:s(()=>[u(m(n.devoir.objet),1)]),_:1})]),_:1}),t(J,null,{default:s(()=>[t(D),(o(!0),f(p,null,k(e.reponses,(i,U)=>(o(),f(p,{key:U},[i.reponses&&i.reponses.length?(o(),c(me,{key:0,"hide-expand-icon":"","default-opened":""},{header:s(()=>[t(w,{avatar:""},{default:s(()=>[t(Z,{square:"",size:"lg"},{default:s(()=>[v("img",{src:r.userPhotoUrl(i.eleve)},null,8,Te)]),_:2},1024)]),_:2},1024),t(w,null,{default:s(()=>[u(m(i.eleve.nom)+" "+m(i.eleve.prenom),1)]),_:2},1024),t(w,{side:""},{default:s(()=>[t($,{label:"non fait",color:"red",modelValue:a.nonfait,"onUpdate:modelValue":[l[0]||(l[0]=_=>a.nonfait=_),r.saveNonfait],val:i.eleve.idpers},null,8,["modelValue","val","onUpdate:modelValue"])]),_:2},1024)]),default:s(()=>[t(J,null,{default:s(()=>[t(D),(o(!0),f(p,null,k(i.reponses,(_,I)=>(o(),f(p,{key:I},[t(ee,null,{default:s(()=>[t(w,null,{default:s(()=>[t(b,null,{default:s(()=>[u(m(_.message),1)]),_:2},1024),_.fichiers&&_.fichiers.length?(o(),c(b,{key:0,lines:"1"},{default:s(()=>[(o(!0),f(p,null,k(_.fichiers,(Q,d)=>(o(),f("div",{outline:"",color:"grey-9",onClick:K(X=>r.openURL(r.pjUrl(Q)),["stop"]),class:"ellipsis rounded-borders q-mr-xs q-pa-xs",style:{"max-width":"40%",display:"inline-block",border:"1px solid var(--q-primary)"}},[t(C,{name:"img:"+r.fileIcon(Q.fichier),size:"14px"},null,8,["name"]),u(" "+m(Q.fichier),1)],8,Ie))),256))]),_:2},1024)):g("",!0)]),_:2},1024)]),_:2},1024),t(D)],64))),128))]),_:2},1024)]),_:2},1024)):(o(),c(ee,{key:1},{default:s(()=>[t(w,{avatar:""},{default:s(()=>[t(Z,{square:"",size:"lg"},{default:s(()=>[v("img",{src:r.userPhotoUrl(i.eleve)},null,8,Ee)]),_:2},1024)]),_:2},1024),t(w,null,{default:s(()=>[u(m(i.eleve.nom)+" "+m(i.eleve.prenom),1)]),_:2},1024),t(w,{side:""},{default:s(()=>[t($,{label:"non fait",color:"red",modelValue:a.nonfait,"onUpdate:modelValue":[l[1]||(l[1]=_=>a.nonfait=_),r.saveNonfait],val:i.eleve.idpers},null,8,["modelValue","val","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)),t(D)],64))),128))]),_:1})]),_:1})}const Ke=P(Se,[["render",Be]]),Je={data(){return{}},props:{title:{default:()=>"Filtre"},form:{default:()=>({rendre:null,objet:null,obligatoire:null})}},computed:{...M({user:"user/user",config:"user/config",current:"user/current"}),uploadFields(){return[{name:"notReponse",value:!0}]},classe(){if(this.current&&this.current.hasOwnProperty("classe"))return this.current.classe},options(){return this.classes},classes(){return this.current&&this.current.hasOwnProperty("classes")?this.current.classes:[]},annee(){if(this.current&&this.current.hasOwnProperty("annee"))return this.current.annee},headers(){return[{name:"Authorization",value:ne.defaults.headers.common.Authorization}]},url(){return ae("api")+"/devoirs/pj"}},methods:{...A({create:"devoirs/create",update:"devoirs/update"}),isDate:re,openURL:ke,minDate(e){return e>=z(new Date,"yyyy/MM/dd")},isImage(e){return ie(this.fileUrl(e))},fileUrl(e){return N(e)},personAvatar(e){return S(e)},send(){this.$refs.form.validate().then(e=>{if(!e)return this.$q.notify({color:"negative",message:this.$t("stats.fields"),position:"bottom",icon:"error_outline",actions:[{label:this.$q.lang.label.close,color:"yellow"}]}),!1;this.sendMessage()})},sendMessage(){this.$emit("devoir:filter",{filter:this.form})},choice(e){this.step=e.value.step,this.$nextTick(()=>{if(this.form.destinataire=this.destinataire.map(n=>n.value.idpers?{type:"personne",id:n.value.idpers,value:"personne_"+n.value.idpers,label:n.label}:n),this.step!=="personnes"&&e.value.value)this.destinataire=null,this.setOptions(),this.$refs.dest.refresh(),this.steps.push(e.value);else if(e.value.value===0)for(var l=0;l<this.steps.length;l++)this.steps[l].step===e.value.step&&delete this.steps[l]})},clear(){this.destinataire=null,this.step=null,this.steps=[],this.setOptions()},hasDiscs(e){return e.value.disciplines&&e.value.disciplines.length},discs(e){return e.value.disciplines[0].description}},activated(){this.cfiles=this.form.fichiers.length}};function Ge(e,l,n,V,a,r){return o(),c(T,null,{default:s(()=>[t(j,{class:H({"bg-secondary":!n.form.status,"bg-positive":n.form.status,"text-white":!0,"shadow-2":!0})},{default:s(()=>[F(t(h,{flat:"",dense:"",icon:"arrow_back"},null,512),[[L]]),t(Y,null,{default:s(()=>l[1]||(l[1]=[u(" Filtre ")])),_:1}),t(h,{class:"q-ml-lg",flat:"",icon:"filter_list",onClick:r.send},null,8,["onClick"])]),_:1},8,["class"]),t(W,{style:{"overflow-y":"scroll"}},{default:s(()=>[t(ve,{class:"q-gutter-lg",ref:"form"},{default:s(()=>[t(B,{filled:"",modelValue:n.form.objet,"onUpdate:modelValue":l[0]||(l[0]=i=>n.form.objet=i),clearable:"",label:"Objet","lazy-rules":"",onKeydown:Ve(r.send,["enter"])},null,8,["modelValue","onKeydown"])]),_:1},512)]),_:1}),t(de,{align:"right"},{default:s(()=>[t(h,{icon:"filter_list",onClick:r.send},{default:s(()=>l[2]||(l[2]=[u("Appliquer")])),_:1},8,["onClick"])]),_:1})]),_:1})}const He=P(Je,[["render",Ge]]),We={emits:["devoir:edit","devoir:remove","devoir:hold","devoir:sent"],components:{EditForm:Me,ReponseEleve:Ke,FilterForm:He},data(){return{videoDialog:!1,video:null,active:null,show:!1,showReponse:!1,showFilter:!1,title:"Devoir",devoir:null,filterForm:{objet:null}}},computed:{...M({user:"user/user",config:"user/config",current:"user/current",form:"devoirs/form",devoirsList:"devoirs/devoirs"}),devoirs(){return this.devoirsList&&this.devoirsList.data?this.devoirsList.data:[]},classe(){if(this.current&&this.current.hasOwnProperty("classe"))return this.current.classe},annee(){if(this.current&&this.current.hasOwnProperty("annee"))return this.current.annee}},methods:{...A({getConfig:"user/getConfig",getDevoirs:"devoirs/getDevoirs",remove:"devoirs/remove",setRefresh:"setRefresh"}),LetterAvatar:ce,toNow:fe,fileIcon:ue,ytbUrls:le,imgFormVid:se,openURL:G,pjUrl:N,playVideo(e){this.video=null,this.video="https://www.youtube.com/embed/"+oe(e[0])+"?rel=0",this.videoDialog=!0},hasFilter(){return this.filterForm.objet&&this.filterForm.objet!=""||this.filterForm.rendre&&this.filterForm.rendre!=""},showDialog(){this.show=!0,this.title="Nouvelle ressource",this.form.reset(),this.form.classes.push(this.classe.idclasse)},filterDialog(){console.log("filter"),this.showFilter=!0},devoirEnvoye({isNew:e}){e?this.getDevoirs({page:1,filter:this.filter()}):this.getData(),this.show=!1,this.$q.notify({color:"positive",message:this.$t("stats.success"),position:"bottom",icon:"check",actions:[{label:this.$q.lang.label.close,color:"white"}]})},getData(){this.showFilter=!1,this.getDevoirs({page:this.devoirsList.current_page,filter:this.filter()})},filter(){let e={annee:this.annee.idannee,classe:[this.classe.idclasse],type:1};return this.filterForm&&(e={...e,...this.filterForm},e.rendre&&(e.rendre=ge(new Date(e.rendre))/1e3)),e},showDelete(e){this.$q.dialog({title:"Suppression",message:"Supprimer ce devoir?",cancel:!0,ok:{label:"Oui",outline:!0,color:"red"},persistent:!0}).onOk(()=>{this.remove(e).then(l=>{this.getData()})})},reponse(e){this.devoir=e,this.showReponse=!0},edit(e){e.id===this.active?this.active=null:e&&!e.status&&(Object.assign(this.form,e),this.form.rendre_le=z(te(this.form.rendre_le),"yyyy-MM-dd"),this.$emit("devoir:edit",{dvr:e,title:"Modifier"}),this.title=this.form.objet,this.form.classes=this.form.classes.map(l=>l.classe_id),this.show=!0)},toDate(e){return Fe.capitalize(z(te(e),"E dd MMM yyyy"))},personAvatar(e){return S(e)},sub(e){return this.$cleanHtml(e,{allowedTags:["b","i","em","strong","a"]})}},watch:{classe(){this.getDevoirs({page:1,filter:this.filter()})}},mounted(){this.setTitle("Ressources Numeriques"),this.getDevoirs({page:1,filter:this.filter()}),this.setRefresh(e=>{this.getDevoirs({page:1,filter:this.filter()}),e()})}},Ye={class:"q-pa-lg flex flex-center"},Xe=["onClick"],Ze={class:"full-width"};function $e(e,l,n,V,a,r){const i=x("ep-pagination"),U=x("edit-form"),_=x("reponse-eleve"),I=x("filter-form"),Q=x("ep-footer");return o(),f(p,null,[t(De,{padding:"",class:"page-content"},{default:s(()=>[v("div",Ye,[e.devoirsList?(o(),c(i,{key:0,modelValue:e.devoirsList.current_page,"onUpdate:modelValue":[l[0]||(l[0]=d=>e.devoirsList.current_page=d),r.getData],max:e.devoirsList.last_page,"direction-links":"","boundary-links":!1,div:"",divClass:"full-width text-center text-white text-bold",dark:"",color:"white",class:"bg-primary full-width",style:{"border-radius":"10rem",height:"30px"}},{content:s(()=>[t(h,{onClick:r.filterDialog,flat:""},{default:s(()=>[r.hasFilter()?(o(),c(q,{key:0,color:"warning",rounded:"",align:"top"})):g("",!0),t(C,{name:"filter_list"}),u(" Page "+m(e.devoirsList.current_page),1)]),_:1},8,["onClick"])]),_:1},8,["modelValue","max","onUpdate:modelValue"])):g("",!0)]),t(T,{style:{margin:"0 -8px"},flat:""},{default:s(()=>[t(J,null,{default:s(()=>[t(D),(o(!0),f(p,null,k(r.devoirs,(d,X)=>(o(),f(p,{key:X},[t(me,{"default-opened":"","hide-expand-icon":"",clickable:"",style:Ce({"border-left":"5px solid "+(d.status?"var(--q-positive)":"var(--q-warning)")}),onClick:y=>r.edit(d),active:a.active===d.id},{header:s(()=>[t(w,null,{default:s(()=>[t(b,{style:{"font-weight":"500"}},{default:s(()=>[v("div",null,m(d.objet),1)]),_:2},1024),t(b,{style:{padding:"12px 0"},lines:"1"},{default:s(()=>[u(m(d.descriptif),1)]),_:2},1024),t(b,null,{default:s(()=>[(o(!0),f(p,null,k(d.classes,(y,E)=>(o(),c(q,{key:"n.id+'-cls-'+icls",color:"blue"},{default:s(()=>[u(m(y.classes.classe_fr),1)]),_:2},1024))),128))]),_:2},1024),d.fichiers.length?(o(),c(b,{key:0,lines:"1"},{default:s(()=>[(o(!0),f(p,null,k(d.fichiers,(y,E)=>(o(),f("div",{outline:"",color:"grey-9",onClick:K(_e=>r.openURL(r.pjUrl(y)),["stop"]),class:"ellipsis rounded-borders q-mr-xs q-pa-xs",style:{"max-width":"40%",display:"inline-block",border:"1px solid var(--q-primary)"}},[t(C,{name:"img:"+r.fileIcon(y.fichier),size:"14px"},null,8,["name"]),u(" "+m(y.fichier),1)],8,Xe))),256))]),_:2},1024)):g("",!0)]),_:2},1024),t(w,{side:"",top:"",style:{position:"relative"}},{default:s(()=>[t(b,{caption:""},{default:s(()=>[u(m(r.toNow(d.created_at*1e3)),1)]),_:2},1024),t(b,{caption:""},{default:s(()=>[d.status?(o(),c(q,{key:0,color:"positive"},{default:s(()=>l[5]||(l[5]=[u("Validé")])),_:1})):(o(),c(q,{key:1,color:"warning"},{default:s(()=>l[6]||(l[6]=[u("En cours")])),_:1}))]),_:2},1024),d.status?g("",!0):(o(),c(b,{key:0,style:{"min-height":"32px","min-width":"32px","margin-top":"16px"}},{default:s(()=>[t(h,{onClick:K(y=>r.showDelete(d),["stop"]),dense:"",flat:"",color:"red",class:"absolute-bottom-right"},{default:s(()=>[t(C,{name:"delete"})]),_:2},1032,["onClick"])]),_:2},1024))]),_:2},1024)]),default:s(()=>[d.descriptif&&r.ytbUrls(d.descriptif).length?(o(),c(W,{key:0,class:"row"},{default:s(()=>[(o(!0),f(p,null,k(r.ytbUrls(d.descriptif),(y,E)=>(o(),f("div",{key:"vid-"+E,class:"col-3 col-md-2 col-lg-1"},[t(he,{ratio:16/9,src:r.imgFormVid(y[0]),onClick:_e=>r.playVideo(y)},{default:s(()=>[t(C,{class:"absolute-center all-pointer-events",size:"32px",name:"play_circle",color:"white"})]),_:2},1032,["src","onClick"])]))),128))]),_:2},1024)):g("",!0)]),_:2},1032,["style","onClick","active"]),t(D)],64))),128))]),_:1})]),_:1}),t(R,{modelValue:a.show,"onUpdate:modelValue":l[1]||(l[1]=d=>a.show=d),maximized:"",position:"bottom"},{default:s(()=>[t(U,{"onDevoir:sent":r.devoirEnvoye,title:a.title},null,8,["onDevoir:sent","title"])]),_:1},8,["modelValue"]),t(R,{modelValue:a.showReponse,"onUpdate:modelValue":l[2]||(l[2]=d=>a.showReponse=d),maximized:"",position:"right"},{default:s(()=>[t(_,{devoir:a.devoir},null,8,["devoir"])]),_:1},8,["modelValue"]),t(R,{modelValue:a.showFilter,"onUpdate:modelValue":l[3]||(l[3]=d=>a.showFilter=d),position:"top"},{default:s(()=>[t(I,{form:a.filterForm,"onDevoir:filter":r.getData},null,8,["form","onDevoir:filter"])]),_:1},8,["modelValue"])]),_:1}),t(R,{modelValue:a.videoDialog,"onUpdate:modelValue":l[4]||(l[4]=d=>a.videoDialog=d)},{default:s(()=>[t(j,{class:"text-white fixed-top"},{default:s(()=>[F(t(h,{flat:"",dense:"",icon:"arrow_back"},null,512),[[L]])]),_:1}),v("div",Ze,[t(pe,{src:a.video,ratio:16/9,frameborder:"0",allowfullscreen:"allowfullscreen"},null,8,["src"])])]),_:1},8,["modelValue"]),t(Q,{to:"#footer-portal"},{default:s(()=>[t(h,{flat:"",onClick:r.showDialog,icon:"add",label:"Nouvelle ressource"},null,8,["onClick"])]),_:1})],64)}const xt=P(We,[["render",$e]]);export{xt as default};
