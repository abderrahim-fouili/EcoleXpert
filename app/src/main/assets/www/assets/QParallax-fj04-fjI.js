import{v as R,cf as _,bO as F,A as g,Y as z,C as I,D as Q,y as w,bp as B,co as A,cp as L,bY as C}from"./index-Bl2lQPd7.js";function T(e){let a=!1,d,r;function l(){r=arguments,a!==!0&&(a=!0,d=window.requestAnimationFrame(()=>{e.apply(this,r),r=void 0,a=!1}))}return l.cancel=()=>{window.cancelAnimationFrame(d),a=!1},l}const{passive:b}=_,M=R({name:"QParallax",props:{src:String,height:{type:Number,default:500},speed:{type:Number,default:1,validator:e=>e>=0&&e<=1},scrollTarget:F,onScroll:Function},setup(e,{slots:a,emit:d}){const r=g(0),l=g(null),H=g(null),P=g(null);let i,t,E,u,f,o;z(()=>e.height,()=>{i===!0&&s()}),z(()=>e.scrollTarget,()=>{i===!0&&(y(),x())});let m=n=>{r.value=n,e.onScroll!==void 0&&d("scroll",n)};function s(){let n,c,h;o===window?(n=0,h=c=window.innerHeight):(n=A(o).top,c=L(o),h=n+c);const S=A(l.value).top,O=S+e.height;if(f!==void 0||O>n&&S<h){const q=(h-S)/(e.height+c);v((E-e.height)*q*e.speed),m(q)}}let v=n=>{t.style.transform=`translate3d(-50%,${Math.round(n)}px,0)`};function p(){E=t.naturalHeight||t.videoHeight||L(t),i===!0&&s()}function x(){i=!0,o=C(l.value,e.scrollTarget),o.addEventListener("scroll",s,b),window.addEventListener("resize",u,b),s()}function y(){i===!0&&(i=!1,o.removeEventListener("scroll",s,b),window.removeEventListener("resize",u,b),o=void 0,v.cancel(),m.cancel(),u.cancel())}return I(()=>{v=T(v),m=T(m),u=T(p),t=a.media!==void 0?H.value.children[0]:P.value,t.onload=t.onloadstart=t.loadedmetadata=p,p(),t.style.display="initial",window.IntersectionObserver!==void 0?(f=new IntersectionObserver(n=>{(n[0].isIntersecting===!0?x:y)()}),f.observe(l.value)):x()}),Q(()=>{y(),f?.disconnect(),t.onload=t.onloadstart=t.loadedmetadata=null}),()=>w("div",{ref:l,class:"q-parallax",style:{height:`${e.height}px`}},[w("div",{ref:H,class:"q-parallax__media absolute-full"},a.media!==void 0?a.media():[w("img",{ref:P,src:e.src})]),w("div",{class:"q-parallax__content absolute-full column flex-center"},a.content!==void 0?a.content({percentScrolled:r.value}):B(a.default))])}});export{M as Q};
